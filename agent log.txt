✅ SQLite database initialized: C:\Users\Rajesh.alda\Downloads\repo3\data\application.sqlite
Processing meetings for user pradeepg@m365x92504196.onmicrosoft.com from source: pm2
Fetching meetings for user: pradeepg@m365x92504196.onmicrosoft.com

╔════════════════════════════════════════════════════════╗
║ 🚀 MEETING FETCH STARTED
║ 👤 User: pradeepg@m365x9...
╚════════════════════════════════════════════════════════╝
🔑 Getting Graph API access token...
 GET /api/auth/session 200 in 91ms
 GET /api/pm2/agent-status?userId=pradeepg%40m365x92504196.onmicrosoft.com 200 in 13ms
✅ Access token acquired successfully

┌─────────────────────────────────────────────────┐
│ 📅 FETCHING MEETINGS FOR EXTENDED WINDOW         │
│ 📆 IST range: 7/30/2025, 12:00:00 AM to              │
│             7/31/2025, 11:59:59 PM              │
│ 🌐 UTC range: 2025-07-28T18:30:00.000Z to              │
│             2025-07-31T18:29:59.999Z              │
└─────────────────────────────────────────────────┘
📡 Fetching meetings from Graph API...
✅ Received 3 meetings from API

┌─────────────────────────────────────────────────┐
│ 🔍 FILTERING MEETINGS FOR EXTENDED WINDOW         │
│ 📊 Total meetings before filtering: 3            │
└─────────────────────────────────────────────────┘

[RAW MEETING 1]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAR4+Fbw==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=",
  "categories": [],
  "subject": "Team 1",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 265 105 580 274 2\r\nPasscode: 5eU2xX3g\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-07-30T13:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-07-30T14:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "983297411",
    "tollNumber": "+1 323-618-1840"
  }
}

[RAW MEETING 2]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAR485LQ==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5VAAA=",
  "categories": [],
  "subject": "lol",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 282 776 678 739 4\r\nPasscode: up9cz9vC\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-07-29T17:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-07-29T17:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "869038008",
    "tollNumber": "+1 323-618-1840"
  }
}

[RAW MEETING 3]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAARl9C6Q==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABGfK_uAAA=",
  "categories": [],
  "subject": "test",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 249 209 925 647 4\r\nPasscode: MZ7zn2rE\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-07-29T08:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-07-29T09:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "515951046",
    "tollNumber": "+1 323-618-1840"
  }
}
📅 AGENT DATE FILTER: Team 1 { scheduled: '2025-07-30', target: '2025-07-30', isScheduledInRange: true }
📅 AGENT DATE FILTER: lol { scheduled: '2025-07-29', target: '2025-07-30', isScheduledInRange: false }
📅 AGENT DATE FILTER: lol { scheduled: '2025-07-29', target: '2025-07-30', hasOnlineMeeting: true, willCheckAttendance: true }
📅 AGENT DATE FILTER: test { scheduled: '2025-07-29', target: '2025-07-30', isScheduledInRange: false }
📅 AGENT DATE FILTER: test { scheduled: '2025-07-29', target: '2025-07-30', hasOnlineMeeting: true, willCheckAttendance: true }

┌─────────────────────────────────────────────────┐
│ ✓ MEETINGS FILTERED                            │
│ 📊 Total meetings after filtering: 3           │
└─────────────────────────────────────────────────┘
📋 Today's meetings:
   1. "Team 1" (01:30 PM - 02:00 PM)
   2. "lol" (05:00 PM - 05:30 PM)
   3. "test" (08:30 AM - 09:00 AM)

┌─────────────────────────────────────────────────┐
│ 🔍 FETCHING ATTENDANCE RECORDS                  │
└─────────────────────────────────────────────────┘
📝 Processing online meeting: "Team 1"
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4@thread.v2
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy')/attendanceReports",
  "value": [
    {
      "id": "5357853f-62a4-4b25-88e2-d015dd9df9af",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-07-30T08:19:15.529Z",
      "meetingEndDateTime": "2025-07-30T08:20:24.013Z",
      "externalEventInformation": []
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ 🔍 ATTENDANCE REPORT TIME WINDOW                │
│ 📅 UTC: 2025-07-29T18:30:00.000Z to       │
│     2025-07-30T18:29:59.999Z                │
│ 🕒 IST: 7/30/2025, 5:30:00 AM to │
│     7/31/2025, 5:29:59 AM    │
│ ⏰ Target Hour IST: 0              │
│ 🌅 Early Morning Target: YES  │
└─────────────────────────────────────────────────┘
Report time check: {
  reportTime: '2025-07-30T08:19:15.529Z',
  reportIST: '2025-07-30 13:49:15',
  reportDateStr: '2025-07-30',
  istTargetDateStr: '2025-07-30',
  reportHourIST: 13,
  isRelevant: 'EXACT_DATE_MATCH'
}
🔧 DEBUG: Enhanced logic version running - relevantReports.length = 1
Found 1 relevant reports, using most recent: 5357853f-62a4-4b25-88e2-d015dd9df9af
Records data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy')/attendanceReports('5357853f-62a4-4b25-88e2-d015dd9df9af')/attendanceRecords",
  "value": [
    {
      "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
      "emailAddress": "PradeepG@M365x92504196.OnMicrosoft.com",
      "totalAttendanceInSeconds": 64,
      "role": "Organizer",
      "registrationId": null,
      "identity": {
        "@odata.type": "#microsoft.graph.communicationsUserIdentity",
        "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
        "displayName": "Pradeep Gupta",
        "tenantId": "d6b48afb-ae93-4180-bd0f-aa47c5c5b57b"
      },
      "attendanceIntervals": [
        {
          "joinDateTime": "2025-07-30T08:19:19.866018Z",
          "leaveDateTime": "2025-07-30T08:20:24.0138126Z",
          "durationInSeconds": 64
        }
      ],
      "externalRegistrationInformation": {
        "referrer": null,
        "registrationId": null
      }
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ ✅ ATTENDANCE RECORDS FOUND                     │
│ 📊 Total Records: 1             │
│ 🕒 Meeting Start: 2025-07-30T08:19:15.529Z │
└─────────────────────────────────────────────────┘
📅 AGENT ATTENDANCE CORRECTION: "Team 1" attended on 2025-07-30 (from joinDateTime: 2025-07-30T08:19:19.866018Z)
Fetching attendance reports from: https://graph.microsoft.com/v1.0/users/90e2f3e7-ee86-4bc6-93ff-ccf55a60c528/onlineMeetings/MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy/attendanceReports
Found report ID: 5357853f-62a4-4b25-88e2-d015dd9df9af
✅ Found 1 attendance records for "Team 1"
📝 Processing online meeting: "lol"
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw@thread.v2        
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OVEV3T0RjNU1ERXRZMlExTXkwME5XSXdMV0ZqTTJJdFlXVTVNRGcxTmpCbFlUY3dAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OVEV3T0RjNU1ERXRZMlExTXkwME5XSXdMV0ZqTTJJdFlXVTVNRGcxTmpCbFlUY3dAdGhyZWFkLnYy')/attendanceReports",
  "value": [
    {
      "id": "e6e93266-1809-43ab-845b-cffdfcd88cf9",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-07-29T11:12:46.12Z",
      "meetingEndDateTime": "2025-07-29T11:15:23.769Z",
      "externalEventInformation": []
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ 🔍 ATTENDANCE REPORT TIME WINDOW                │
│ 📅 UTC: 2025-07-29T18:30:00.000Z to       │
│     2025-07-30T18:29:59.999Z                │
│ 🕒 IST: 7/30/2025, 5:30:00 AM to │
│     7/31/2025, 5:29:59 AM    │
│ ⏰ Target Hour IST: 0              │
│ 🌅 Early Morning Target: YES  │
└─────────────────────────────────────────────────┘
Report time check: {
  reportTime: '2025-07-29T11:12:46.12Z',
  reportIST: '2025-07-29 16:42:46',
  reportDateStr: '2025-07-29',
  istTargetDateStr: '2025-07-30',
  reportHourIST: 16,
  isRelevant: 'DATE_MISMATCH_EXCLUDED'
}
No attendance reports found within the IST day window
📝 Processing online meeting: "test"
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw@thread.v2        
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19ZMkZqTlRNMlpEVXRNVGt4WmkwME9HWTFMV0UxWkRBdE9EUmhZalEyTmpGaE9UUXdAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19ZMkZqTlRNMlpEVXRNVGt4WmkwME9HWTFMV0UxWkRBdE9EUmhZalEyTmpGaE9UUXdAdGhyZWFkLnYy')/attendanceReports",
  "value": []
}
✅ AGENT FINAL FILTER: Including Team 1 (timeEntryDate: 2025-07-30)
❌ AGENT FINAL FILTER: Excluding lol (timeEntryDate: undefined, target: 2025-07-30)
❌ AGENT FINAL FILTER: Excluding test (timeEntryDate: undefined, target: 2025-07-30)

╔════════════════════════════════════════════════════════╗
║ 🏁 MEETING FETCH COMPLETED
║ 📊 Total meetings: 1 | With attendance: 1
║ 👥 Unique attendees: 0
╚════════════════════════════════════════════════════════╝
Found 1 meetings for processing

╔════════════════════════════════════════════════════════╗
║ 🔄 STARTING BATCH PROCESSING [batch_1753869856098_2dug5horp]
║ 📊 Total meetings: 1
║ 🆔 Cycle ID: cycle_1753869856098
╚════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ ▶️ Processing batch 1/1 (1 meetings) │
└─────────────────────────────────────────────────┘
📶 Rate limiter status: 48/5 tokens available
✅ Rate limiter tokens acquired
📑 Processing meeting: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]
📥 QUEUE: Added meeting "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]
📊 QUEUE STATUS: 1 item waiting
⚙️ QUEUE: Starting queue processor...

╔════════════════════════════════════════════════════════╗
║ 🔄 QUEUE PROCESSOR STARTED                             ║
║ 🆔 Cycle ID: cycle_1753869856100                   ║
║ 📊 Queue Length: 1                  ║
╚════════════════════════════════════════════════════════╝
✅ RATE LIMITER: Token acquired, processing next queue item
🔍 PROCESSING: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]

┌─────────────────── MEETING TIME INFO ─────────────────────┐
│ 📅 Meeting UTC: 2025-07-30T13:30:00.0000000                 │
│ 🕒 Meeting IST: 7/30/2025, 1:30:00 PM                        │
│ ⏰ Hour (IST): 13                     │
│ 🌅 Early Morning: NO        │
│ 🎯 Target Date: 2025-07-30        │
│ 📊 Validation Date: 2025-07-30T00:00:00.0000000                        │
└─────────────────────────────────────────────────────────┘
🔧 DEBUG: Starting validation of 1 reports
🔧 DEBUG: Validating report 1/1: 5357853f-62a4-4b25-88e2-d015dd9df9af
Report validation [IST]: Report date: 2025-07-30, Target date: 2025-07-30
🔧 DEBUG: Report 5357853f-62a4-4b25-88e2-d015dd9df9af validation result: {
  isValid: true,
  reason: 'Report is valid for the specified date',
  reportDate: '2025-07-30',
  duration: 68.484
}
✅ DEBUG: Report 5357853f-62a4-4b25-88e2-d015dd9df9af is VALID - added to validReports
🔧 DEBUG: Validation complete. Valid reports: 1/1
Selected single report ID: 5357853f-62a4-4b25-88e2-d015dd9df9af Reason: Single valid report available
✅ COMPLETED: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=] in 3.78s

╔════════════════════════════════════════════════════════╗
║ ✅ QUEUE PROCESSOR COMPLETED                           ║
║ 🆔 Cycle ID: cycle_1753869856100                   ║
║ ⏱️ Duration: 5.04s      ║
╚════════════════════════════════════════════════════════╝
✅ Successfully processed: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      │
│ ✓ Progress: 1/1 meetings (100%)    │
│ ✓ Success: 1 | Failed: 0               │
└─────────────────────────────────────────────────┘

╔════════════════════════════════════════════════════════╗
║ 🏁 BATCH PROCESSING COMPLETED [batch_1753869856098_2dug5horp]
║ 📊 Total: 1 | Success: 1 | Failed: 0
║ 📈 Success rate: 100%
╚════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════╗
║ ⏱️ CYCLE COMPLETED                                     ║
║ 🆔 Cycle ID: null                   ║
║ ⌛ Duration: 5.04s      ║
╚════════════════════════════════════════════════════════╝
Started batch processing with ID: batch_1753869856098_2dug5horp
Progress: 1/1 meetings processed
All meetings processed
Successfully processed 1 meetings
Filtering out already processed meetings and meetings the user didn't attend...

╔══════════════════════════════════════════════════════════╗
║ 🔍 MEETING FILTER STARTING                                ║
║ 📊 Input meetings: 1 | After dedup: 1                    ║
║ 🔄 Batch size: 3 | Delay: 15s                        ║
╚══════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ 📦 Processing batch 1/1 (1 meetings) ║
└─────────────────────────────────────────────────┘
🔧 DEBUG: Checking meeting "Team 1"
🔧 DEBUG: meeting.attendance exists: true
🔧 DEBUG: allValidReports length: 1
🔧 DEBUG: allValidReports: [
  {
    selectedReportId: '5357853f-62a4-4b25-88e2-d015dd9df9af',
    confidence: 1,
    reason: 'Single valid report available',
    metadata: {
      date: '2025-07-30T00:00:00.0000000',
      duration: 68.484,
      isRecurring: false,
      totalReports: 1
    }
  }
]
🔧 DEBUG: meeting.attendance.reportId: 5357853f-62a4-4b25-88e2-d015dd9df9af
✅ Unique: "Team 1" [AAMkADZhZTY4Njl...] with report ID 5357853f-62a4-4b25-88e2-d015dd9df9af

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      ║
│ 📊 Total: 1 | Unique: 1 | Duplicates: 0   ║
└─────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════╗
║ 🏁 MEETING FILTER COMPLETED                               ║
║ 📊 Processed: 1 | Duplicates: 0 | Unique: 1     ║
║ 📈 Duplication rate: 0%                                   ║
╚══════════════════════════════════════════════════════════╝
User pradeepg@m365x92504196.onmicrosoft.com attended meeting "Team 1" for 64 seconds
Found 1 unique meetings, 1 of which were attended by the user
Checking review queue for meetings that might now have matching tasks...
Found 0 meetings in review queue for user pradeepg@m365x92504196.onmicrosoft.com
Review queue reportIds: []
Filtered meetings: 1 total → 1 new (0 already in review)
Total meetings to process (new: 1 + review: 0): 1
Matching tasks to all meetings (new + review queue)...
Matching tasks for meeting: Team 1
Found user's attendance record with duration: 64 seconds
Getting API key from SQLite for user: pradeepg@m365x92504196.onmicrosoft.com
Database: Looking up user by email: pradeepg@m365x92504196.onmicrosoft.com
Database: Found user pradeepg@m365x92504196.onmicrosoft.com with API key: Yes
API key found in SQLite database for user: pradeepg@m365x92504196.onmicrosoft.com
Fetching tasks from Intervals for user: pradeepg@m365x92504196.onmicrosoft.com
Fetching tasks using standard API implementation...
Current user personid: 425182
Raw tasks API response: Found 5 total tasks
Total tasks from API: 5
Task 16774501 (Daily Status Report) skipped: Task is closed
Found 4 open tasks assigned to user 425182
Standard API returned 4 tasks
Found 4 tasks in Intervals:
- WD task internal (16774641)
- testing department QA (16774644)
- migration task (16774646)
- sandisk task (16774660)
Meeting analysis for matching: {
  "subject": "Team 1",
  "startTime": "2025-07-30T13:30:00.0000000",
  "endTime": "2025-07-30T14:00:00.0000000",
  "duration": 64,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "Pradeep Gupta",
        "email": "PradeepG@M365x92504196.OnMicrosoft.com",
        "duration": 64,
        "role": "Organizer",
        "attendanceIntervals": [
          {
            "joinDateTime": "2025-07-30T08:19:19.866018Z",
            "leaveDateTime": "2025-07-30T08:20:24.0138126Z",
            "durationInSeconds": 64
          }
        ]
      }
    ],
    "summary": {
      "totalDuration": 64,
      "averageDuration": 64,
      "totalParticipants": 1
    },
    "reportId": "5357853f-62a4-4b25-88e2-d015dd9df9af",
    "allValidReports": [
      {
        "selectedReportId": "5357853f-62a4-4b25-88e2-d015dd9df9af",
        "confidence": 1,
        "reason": "Single valid report available",
        "metadata": {
          "date": "2025-07-30T00:00:00.0000000",
          "duration": 68.484,
          "isRecurring": false,
          "totalReports": 1
        }
      }
    ]
  }
}
Tasks data for matching: [
  {
    "id": "16774641",
    "title": "WD task internal",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774644",
    "title": "testing department QA",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553551",
    "module": "Quality Assurance",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774646",
    "title": "migration task",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774660",
    "title": "sandisk task",
    "projectid": "1433679",
    "project": "Sandisk Migration",
    "status": "Open",
    "priority": "3",
    "clientid": "392220",
    "client": "Sandisk",
    "moduleid": "553550",
    "module": "Development",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Sandisk Migration"
    }
  }
]
Generated prompt for OpenAI: You are an AI assistant for an IT company that matches technical meetings with appropriate development tasks. Your goal is time tracking, not perfect categorization - a reasonable guess is better than no match.

Meeting Details:
{
  "subject": "Team 1",
  "startTime": "2025-07-30T13:30:00.0000000",
  "endTime": "2025-07-30T14:00:00.0000000",
  "duration": 64,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "Pradeep Gupta",
        "email": "PradeepG@M365x92504196.OnMicrosoft.com",
        "duration": 64,
        "role": "Organizer",
        "attendanceIntervals": [
          {
            "joinDateTime": "2025-07-30T08:19:19.866018Z",
            "leaveDateTime": "2025-07-30T08:20:24.0138126Z",
            "durationInSeconds": 64
          }
        ]
      }
    ],
    "summary": {
      "totalDuration": 64,
      "averageDuration": 64,
      "totalParticipants": 1
    },
    "reportId": "5357853f-62a4-4b25-88e2-d015dd9df9af",
    "allValidReports": [
      {
        "selectedReportId": "5357853f-62a4-4b25-88e2-d015dd9df9af",
        "confidence": 1,
        "reason": "Single valid report available",
        "metadata": {
          "date": "2025-07-30T00:00:00.0000000",
          "duration": 68.484,
          "isRecurring": false,
          "totalReports": 1
        }
      }
    ]
  }
}

Available Tasks:
[
  {
    "id": "16774641",
    "title": "WD task internal",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774644",
    "title": "testing department QA",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553551",
    "module": "Quality Assurance",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774646",
    "title": "migration task",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774660",
    "title": "sandisk task",
    "projectid": "1433679",
    "project": "Sandisk Migration",
    "status": "Open",
    "priority": "3",
    "clientid": "392220",
    "client": "Sandisk",
    "moduleid": "553550",
    "module": "Development",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Sandisk Migration"
    }
  }
]

CORE PHILOSOPHY:
FIND MEANINGFUL MATCHES - The goal is accurate time tracking with reasonable confidence. When no clear connection exists, let human reviewers decide.

SMART MATCHING STRATEGY:

1. MULTI-LAYER MATCHING APPROACH
Apply these layers in order, but STOP if no reasonable connection is found:

Layer 1: EXACT/DIRECT matches (keywords, project names, client names, abbreviations)
- SD → SanDisk (check for "sandisk task" FIRST)
- WD → Western Digital
- Client names must match exactly before considering parent companies
- COMPANY PREFIX PRIORITY: When both company abbreviation AND shared keywords exist, company match wins
- Example: "SD: Separation project" → "Sandisk Tenant Separation" (SD+Separation = strong match)
- Example: "WD: Separation project" → "Sandisk Tenant Separation" (No match - WD≠SanDisk, despite shared "Separation")

Layer 2: SEMANTIC matches (related concepts, synonyms, context clues)
- Employee events → HR tasks
- Celebrations, parties, team building → HR Meetings
- Training, onboarding, reviews → HR tasks
- Benefits, policies, announcements → HR tasks

Layer 3: DEPARTMENTAL matches (meeting type suggests department)
- HR DEPARTMENT: celebrations, founder day, employee events, team building, training, reviews, benefits, policies, announcements, company events
- Development: coding, programming, APIs, features, bugs
- QA: testing, quality, bugs, defects
- DevOps: deployment, pipelines, infrastructure
- Support: tickets, incidents, troubleshooting
Layer 4: COMPANY/CLIENT matches (team calls, client meetings, but NOT parent company substitutions)
Layer 5: CONTEXTUAL matches (user's most active projects/clients)

STOP HERE: If no match found in layers 1-5, return empty array for human review

CRITICAL: Layer 1 matches take absolute priority. Company abbreviation + keyword combination beats keyword-only matches.

2. DYNAMIC ABBREVIATION & SYNONYM RECOGNITION
INTELLIGENT MATCHING RULES:
- Extract company names from meeting titles and match to task clients
- Recognize common abbreviations:
  * WD = Western Digital
  * SD = SanDisk
  * MS = Microsoft
  * AWS = Amazon Web Services
- COMPANY + KEYWORD COMBINATION MATCHING:
  * "SD: Separation project" + "Sandisk Tenant Separation" = STRONG MATCH (company + keyword)
  * "WD: Separation project" + "Sandisk Tenant Separation" = NO MATCH (wrong company, despite shared keyword)
  * Company abbreviation must align with task client for keyword matches to be valid
- ALWAYS check for EXACT client/company matches FIRST before looking for parent companies
- Match team/department calls to relevant departmental tasks
- Connect project codenames to actual project names
- Associate meeting attendees with their typical project areas
- Link recurring meeting patterns to ongoing tasks

3. CONFIDENCE SCORING FRAMEWORK
CONFIDENCE CALCULATION:
- 1.0: Exact keyword/title match
- 0.8-0.9: Strong semantic or company match
- 0.6-0.7: Good contextual or departmental match
- 0.4-0.5: Reasonable connection based on patterns
- 0.2-0.3: Weak but logical connection
- 0.0: No meaningful connection found (return empty array)

4. CONTEXT-AWARE ANALYSIS
ANALYZE THESE ELEMENTS:
- Meeting title/subject (primary indicator)
- Meeting duration (quick calls vs long planning sessions)
- Attendees (if available) and their roles
- Time of day/week patterns
- Recurring vs one-time meetings
- Client/company references in any form
- Technical keywords or jargon
- Project phases (planning, development, testing, deployment)

5. QUALITY GATE DECISION PROCESS
BEFORE RETURNING A MATCH, ASK:
1. "Is there a logical connection between this meeting and this task?"
2. "Would a reasonable person agree this meeting relates to this task?"
3. "Am I forcing a match just to avoid returning empty?"
4. "Is this meeting subject too generic or vague to confidently categorize?"

GENERIC/VAGUE MEETING FILTER:
NEVER match these types of generic subjects:
- Single words without context: "meeting", "call", "discussion", "sync"
- Random words unrelated to work: "joker", "test", "random", "hello"
- Generic numbered meetings: "meeting 1", "meeting 7", "call 2"
- Overly broad terms: "urgent meeting", "quick call", "catch up"
- Personal names only without context: "John", "Sarah", "Mike"

IF THE ANSWER TO ANY QUALITY GATE QUESTION IS "NO" → Return empty array for human review

WHEN TO RETURN EMPTY ARRAY:
- Meeting subject is generic, vague, or lacks meaningful context
- No clear semantic, company, or contextual connection exists
- Meeting subject is completely unrelated to available tasks (like "joker", "random")
- You're unsure about the connection and just guessing
- The match feels forced or artificial

WHEN TO RETURN A MATCH:
- Clear keyword, company, or semantic connection exists
- Meeting has specific, work-related context
- Meeting type logically relates to task department/function
- Reasonable person would agree there's a meaningful connection

6. PATTERN RECOGNITION
RECOGNIZE THESE PATTERNS:
- "Daily standup" → Daily Status Report tasks
- "Client call" → Tasks for that client
- "Team sync" → Internal coordination tasks
- "Planning session" → Project planning tasks
- "Review meeting" → QA or approval tasks
- "Troubleshooting" → Support or development tasks
- Person names only → Match to their typical collaboration areas

HR & EMPLOYEE EVENT PATTERNS:
- "Founder day", "Company celebration", "Team building" → HR Meetings/HR tasks
- "Employee training", "Onboarding", "Performance review" → HR tasks
- "Benefits meeting", "Policy discussion", "Company announcement" → HR tasks
- "Holiday party", "Team lunch", "Employee appreciation" → HR Meetings
- "All hands", "Town hall", "Company meeting" → HR or internal coordination tasks

AVOID GENERIC MATCHES:
- DO NOT match generic words like "meeting", "call", "sync" to HR tasks just because they contain meeting-related terms
- DO NOT match random or unrelated words like "joker", "test", "hello" to any tasks
- DO NOT match numbered generic meetings like "meeting 7", "call 2" without additional context
- REQUIRE specific, contextual keywords for HR matching (not just the word "meeting")

7. UNIVERSAL CLIENT/COMPANY MATCHING
COMPANY IDENTIFICATION:
- Extract any company names, abbreviations, or brand references
- Match meeting organizer's domain to potential clients
- Recognize common business abbreviations dynamically
- Connect subsidiary names to parent companies
- Match product names to their manufacturers

8. ADAPTIVE REASONING APPROACH
THINK LIKE A PROJECT MANAGER:
- Consider: "What would this meeting most likely be about?"
- Ask: "Which task would benefit from this meeting time?"
- Remember: "Imperfect categorization is better than no categorization"
- Default: "When in doubt, pick the most active relevant task"

IT DEPARTMENT SPECIALIZATIONS:
1. Software Development:
   - Topics: API integration, code reviews, software architecture, sprint planning, bug fixes, feature development
   - Keywords: coding, development, programming, frontend, backend, APIs, database, frameworks, libraries

2. DevOps & CI/CD:
   - Topics: pipeline automation, deployment strategies, infrastructure as code, continuous integration
   - Keywords: Jenkins, Docker, Kubernetes, GitLab CI, GitHub Actions, pipelines, automation, deployment

3. Infrastructure & Cloud:
   - Topics: server management, cloud architecture, network configuration, capacity planning
   - Keywords: AWS, Azure, GCP, servers, VMs, containers, networking, storage, load balancing

4. QA & Testing:
   - Topics: test planning, automation testing, quality assurance, regression testing, performance testing
   - Keywords: QA, testing, test cases, test automation, quality, bugs, defects, selenium, cypress

5. IT Support & Helpdesk:
   - Topics: incident management, user support, troubleshooting, ticket resolution
   - Keywords: tickets, support, helpdesk, incidents, user problems, troubleshooting, service desk

6. Security & Compliance:
   - Topics: vulnerability assessment, security audits, compliance monitoring, access management
   - Keywords: security, vulnerabilities, audits, compliance, firewall, authentication, authorization

7. Data & Analytics:
   - Topics: data modeling, analytics implementation, reporting, database management
   - Keywords: data warehouse, ETL, analytics, reporting, dashboards, BI, SQL, data modeling

8. System Administration:
   - Topics: system maintenance, updates, monitoring, user management
   - Keywords: Active Directory, user accounts, system updates, monitoring, patching, SCCM, Intune

9. Human Resources & Administration:
   - Topics: employee events, celebrations, training, reviews, benefits, policies, company meetings
   - Keywords: HR, founder day, celebration, party, team building, training, onboarding, benefits, policy, announcement, all hands, town hall, employee, company event

MATCHING RULES:
1. ONLY match with tasks that are assigned to the current user (check assigneeid field)
2. NEVER match with tasks that have a "Closed" status
3. PRIORITIZE EXACT CLIENT/COMPANY MATCHES over parent company relationships
4. COMPANY + KEYWORD VALIDATION: Both company abbreviation AND keywords must align with the same task
5. If the client is "Nathcorp", note that these are internal non-billable tasks
6. Apply multi-layer matching approach systematically - but Layer 1 (EXACT) takes absolute priority
7. Use dynamic abbreviation and synonym recognition with company validation
8. Always attempt contextual and pattern-based matching
9. Meeting duration is NOT a reliable indicator of meeting type

DISAMBIGUATION LOGIC:
- When multiple meetings share keywords but have different company prefixes
- Only match the meeting whose company abbreviation aligns with the task client
- Example: "SD: X" matches "Sandisk X task", "WD: X" does NOT match "Sandisk X task"

OUTPUT REQUIREMENTS:
RETURN A MATCH ONLY WHEN:
- There's a logical connection between meeting and task
- Confidence is at least 0.2 (weak but logical connection)
- A reasonable person would agree the match makes sense

RETURN EMPTY ARRAY WHEN:
- Meeting subject is generic, vague, or lacks meaningful context
- No meaningful connection can be established
- All potential matches feel forced or artificial
- You're just guessing without logical basis
- Meeting subject is random/unrelated (like "joker", "test", "hello")
- Generic numbered meetings without context ("meeting 7", "call 2")
- Single generic words ("meeting", "call", "sync", "discussion")
- Meeting is clearly personal/non-work related
- No tasks are assigned to the user
- All tasks are closed

HUMAN REVIEW IS VALUABLE - Don't avoid it by forcing poor matches.

EXAMPLE MATCHING LOGIC:

Meeting: "Western Digital Team Call"
Analysis:
1. Company identified: "Western Digital"
2. Check for "WD", "Western Digital", "Western", "Digital" in tasks
3. Found: "WD task internal" - strong company match
4. Confidence: 0.7 (clear company connection)
5. Match found!

Meeting: "meetings"
Analysis:
1. Keywords: "meetings" (generic singular word)
2. This is a generic term without specific context
3. Quality gate check: "Is this too generic to confidently categorize?" → Yes
4. Quality gate check: "Would a reasonable person agree 'meetings' relates to HR Meetings?" → No, too vague
5. DECISION: Return empty array - meeting subject lacks meaningful context
6. Result: No match found - needs human review

Meeting: "joker"
Analysis:
1. Keywords: "joker" (random, unrelated to work)
2. No work-related context or meaning
3. Quality gate check: "Is there logical connection to any task?" → No
4. Quality gate check: "Is this random/unrelated?" → Yes
5. DECISION: Return empty array - completely unrelated subject
6. Result: No match found - needs human review

Meeting: "urgent meeting"
Analysis:
1. Keywords: "urgent", "meeting" (generic/vague)
2. "Urgent" adds no specific context about meeting purpose
3. Quality gate check: "Is this too generic to confidently categorize?" → Yes
4. Quality gate check: "Would reasonable person agree this relates to specific task?" → No, could be anything
5. DECISION: Return empty array - lacks meaningful context
6. Result: No match found - needs human review

Meeting: "WD: Separation project 4"
Analysis:
1. Keywords: "WD", "Separation", "project"
2. "WD" = "Western Digital" (company abbreviation)
3. Check available tasks for Western Digital + Separation keywords
4. Found: "Sandisk Tenant Separation client call" - but this is SanDisk, not Western Digital
5. Company mismatch: WD (Western Digital) ≠ SanDisk
6. Quality gate check: "Would WD separation work relate to SanDisk task?" → No logical connection
7. DECISION: Return empty array - company abbreviations don't align
8. Result: No match found - needs human review

Meeting: "API Discussion"
Analysis:
1. Technical keyword: "API"
2. Look for development, integration, or technical tasks
3. Match to relevant development task
4. Confidence: 0.8 (clear technical match)
5. Match found!

Meeting: "Task Test 1"
Analysis:
1. Keywords: "Task", "Test"
2. "Test" suggests QA/Testing department
3. Look for testing, QA, or quality assurance tasks
4. Found: "testing department QA" - semantic match
5. Confidence: 0.6 (clear testing context)
6. Match found!

Analyze the meeting and tasks using the universal matching strategy, then provide your response in the following JSON format:

{
    "matchedTasks": [
        {
            "taskId": "string",
            "taskTitle": "string",
            "meetingDetails": {
                "subject": "string",
                "startTime": "string",
                "endTime": "string",
                "actualDuration": number  // Use the duration from attendance records in seconds
            },
            "confidence": number,
            "reason": "string"
        }
    ]
}

Notes:
1. Apply the multi-layer matching approach systematically
2. Use adaptive reasoning like a project manager
3. Always attempt to find at least one match for work meetings
4. Confidence should reflect the matching layer used
5. Provide clear reasoning for the match found
6. Return valid JSON that can be parsed directly
7. Include all required fields for each task
8. The actualDuration should be taken from attendance records in seconds
9. Think inclusively but don't force matches - quality over quantity
10. Remember: Human review is valuable for ambiguous cases
OpenAI response: {
    "matchedTasks": []
}
Raw OpenAI response: {
    "matchedTasks": []
}
Extracted JSON: {
    "matchedTasks": []
}
Parsed tasks: []
Parsed matching result: {
  "meetingSubject": "Team 1",
  "matchedTasks": []
}
No matches found for meeting: Team 1, queueing for review
Found user's attendance record with duration: 64 seconds
Meeting queued for review with reportId: 5357853f-62a4-4b25-88e2-d015dd9df9af
Adding new meeting with ID AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA= for user pradeepg@m365x92504196.onmicrosoft.com to reviews
Meeting queued for review: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA= - Team 1
Meeting queued for review: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA= - Team 1
Creating time entries...
Skipping time entry creation for meeting: Team 1 - Needs review


📝 REVIEWS DATA:
NaN
📊 Showing latest 1 reviews:

📝 Review 1:
🆔 ID: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=
👤 User: pradeepg@m365x92504196.onmicrosoft.com
📋 Subject: Team 1
📊 Status: pending
🎯 Confidence: 0
📊 Report ID: 5357853f-62a4-4b25-88e2-d015dd9df9af
📅 Created: 2025-07-30 10:04:23
---

second round :

Processing meetings for user pradeepg@m365x92504196.onmicrosoft.com from source: pm2
Fetching meetings for user: pradeepg@m365x92504196.onmicrosoft.com

╔════════════════════════════════════════════════════════╗
║ 🚀 MEETING FETCH STARTED
║ 👤 User: pradeepg@m365x9...
╚════════════════════════════════════════════════════════╝
🔑 Getting Graph API access token...
✅ Access token acquired successfully

┌─────────────────────────────────────────────────┐
│ 📅 FETCHING MEETINGS FOR EXTENDED WINDOW         │
│ 📆 IST range: 7/30/2025, 12:00:00 AM to              │
│             7/31/2025, 11:59:59 PM              │
│ 🌐 UTC range: 2025-07-28T18:30:00.000Z to              │
│             2025-07-31T18:29:59.999Z              │
└─────────────────────────────────────────────────┘
📡 Fetching meetings from Graph API...
✅ Received 3 meetings from API

┌─────────────────────────────────────────────────┐
│ 🔍 FILTERING MEETINGS FOR EXTENDED WINDOW         │
│ 📊 Total meetings before filtering: 3            │
└─────────────────────────────────────────────────┘

[RAW MEETING 1]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAR4+Fbw==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=",
  "categories": [],
  "subject": "Team 1",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 265 105 580 274 2\r\nPasscode: 5eU2xX3g\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-07-30T13:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-07-30T14:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "983297411",
    "tollNumber": "+1 323-618-1840"
  }
}

[RAW MEETING 2]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAR485LQ==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5VAAA=",
  "categories": [],
  "subject": "lol",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 282 776 678 739 4\r\nPasscode: up9cz9vC\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-07-29T17:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-07-29T17:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "869038008",
    "tollNumber": "+1 323-618-1840"
  }
}

[RAW MEETING 3]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAARl9C6Q==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABGfK_uAAA=",
  "categories": [],
  "subject": "test",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 249 209 925 647 4\r\nPasscode: MZ7zn2rE\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-07-29T08:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-07-29T09:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "515951046",
    "tollNumber": "+1 323-618-1840"
  }
}
📅 AGENT DATE FILTER: Team 1 { scheduled: '2025-07-30', target: '2025-07-30', isScheduledInRange: true }
📅 AGENT DATE FILTER: lol { scheduled: '2025-07-29', target: '2025-07-30', isScheduledInRange: false }
📅 AGENT DATE FILTER: lol { scheduled: '2025-07-29', target: '2025-07-30', hasOnlineMeeting: true, willCheckAttendance: true }
📅 AGENT DATE FILTER: test { scheduled: '2025-07-29', target: '2025-07-30', isScheduledInRange: false }
📅 AGENT DATE FILTER: test { scheduled: '2025-07-29', target: '2025-07-30', hasOnlineMeeting: true, willCheckAttendance: true }

┌─────────────────────────────────────────────────┐
│ ✓ MEETINGS FILTERED                            │
│ 📊 Total meetings after filtering: 3           │
└─────────────────────────────────────────────────┘
📋 Today's meetings:
   1. "Team 1" (01:30 PM - 02:00 PM)
   2. "lol" (05:00 PM - 05:30 PM)
   3. "test" (08:30 AM - 09:00 AM)

┌─────────────────────────────────────────────────┐
│ 🔍 FETCHING ATTENDANCE RECORDS                  │
└─────────────────────────────────────────────────┘
📝 Processing online meeting: "Team 1"
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_NWMxNTQ3ZmUtY2I5MC00YzkzLThiMDAtNjI4NTViZTQ3MTU4@thread.v2        
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy')/attendanceReports",
  "value": [
    {
      "id": "c1ab2627-9bb0-4e61-a09f-feb1ef598a41",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-07-30T10:13:44.695Z",
      "meetingEndDateTime": "2025-07-30T10:15:08.094Z",
      "externalEventInformation": []
    },
    {
      "id": "5357853f-62a4-4b25-88e2-d015dd9df9af",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-07-30T08:19:15.529Z",
      "meetingEndDateTime": "2025-07-30T08:20:24.013Z",
      "externalEventInformation": []
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ 🔍 ATTENDANCE REPORT TIME WINDOW                │
│ 📅 UTC: 2025-07-29T18:30:00.000Z to       │
│     2025-07-30T18:29:59.999Z                │
│ 🕒 IST: 7/30/2025, 5:30:00 AM to │
│     7/31/2025, 5:29:59 AM    │
│ ⏰ Target Hour IST: 0              │
│ 🌅 Early Morning Target: YES  │
└─────────────────────────────────────────────────┘
Report time check: {
  reportTime: '2025-07-30T10:13:44.695Z',
  reportIST: '2025-07-30 15:43:44',
  reportDateStr: '2025-07-30',
  istTargetDateStr: '2025-07-30',
  reportHourIST: 15,
  isRelevant: 'EXACT_DATE_MATCH'
}
Report time check: {
  reportTime: '2025-07-30T08:19:15.529Z',
  reportIST: '2025-07-30 13:49:15',
  reportDateStr: '2025-07-30',
  istTargetDateStr: '2025-07-30',
  reportHourIST: 13,
  isRelevant: 'EXACT_DATE_MATCH'
}
🔧 DEBUG: Enhanced logic version running - relevantReports.length = 2
🔄 Found 2 valid reports for meeting (user rejoined multiple times) - processing all reports
Using latest report for attendance records: c1ab2627-9bb0-4e61-a09f-feb1ef598a41
Records data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy')/attendanceReports('c1ab2627-9bb0-4e61-a09f-feb1ef598a41')/attendanceRecords",
  "value": [
    {
      "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
      "emailAddress": "PradeepG@M365x92504196.OnMicrosoft.com",
      "totalAttendanceInSeconds": 80,
      "role": "Organizer",
      "registrationId": null,
      "identity": {
        "@odata.type": "#microsoft.graph.communicationsUserIdentity",
        "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
        "displayName": "Pradeep Gupta",
        "tenantId": "d6b48afb-ae93-4180-bd0f-aa47c5c5b57b"
      },
      "attendanceIntervals": [
        {
          "joinDateTime": "2025-07-30T10:13:47.7401755Z",
          "leaveDateTime": "2025-07-30T10:15:08.0944483Z",
          "durationInSeconds": 80
        }
      ],
      "externalRegistrationInformation": {
        "referrer": null,
        "registrationId": null
      }
    }
  ]
}
✅ Added metadata for 2 reports to enable multi-instance processing

┌─────────────────────────────────────────────────┐
│ ✅ ATTENDANCE RECORDS FOUND                     │
│ 📊 Total Records: 1             │
│ 🕒 Meeting Start: 2025-07-30T10:13:44.695Z │
│ 🔄 Total Reports: 2 (metadata attached) │
└─────────────────────────────────────────────────┘
📅 AGENT ATTENDANCE CORRECTION: "Team 1" attended on 2025-07-30 (from joinDateTime: 2025-07-30T10:13:47.7401755Z)
Fetching attendance reports from: https://graph.microsoft.com/v1.0/users/90e2f3e7-ee86-4bc6-93ff-ccf55a60c528/onlineMeetings/MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OV014TlRRM1ptVXRZMkk1TUMwMFl6a3pMVGhpTURBdE5qSTROVFZpWlRRM01UVTRAdGhyZWFkLnYy/attendanceReports
Found report ID: c1ab2627-9bb0-4e61-a09f-feb1ef598a41
✅ Found 1 attendance records for "Team 1"
📝 Processing online meeting: "lol"
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_NTEwODc5MDEtY2Q1My00NWIwLWFjM2ItYWU5MDg1NjBlYTcw@thread.v2        
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OVEV3T0RjNU1ERXRZMlExTXkwME5XSXdMV0ZqTTJJdFlXVTVNRGcxTmpCbFlUY3dAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19OVEV3T0RjNU1ERXRZMlExTXkwME5XSXdMV0ZqTTJJdFlXVTVNRGcxTmpCbFlUY3dAdGhyZWFkLnYy')/attendanceReports",
  "value": [
    {
      "id": "e6e93266-1809-43ab-845b-cffdfcd88cf9",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-07-29T11:12:46.12Z",
      "meetingEndDateTime": "2025-07-29T11:15:23.769Z",
      "externalEventInformation": []
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ 🔍 ATTENDANCE REPORT TIME WINDOW                │
│ 📅 UTC: 2025-07-29T18:30:00.000Z to       │
│     2025-07-30T18:29:59.999Z                │
│ 🕒 IST: 7/30/2025, 5:30:00 AM to │
│     7/31/2025, 5:29:59 AM    │
│ ⏰ Target Hour IST: 0              │
│ 🌅 Early Morning Target: YES  │
└─────────────────────────────────────────────────┘
Report time check: {
  reportTime: '2025-07-29T11:12:46.12Z',
  reportIST: '2025-07-29 16:42:46',
  reportDateStr: '2025-07-29',
  istTargetDateStr: '2025-07-30',
  reportHourIST: 16,
  isRelevant: 'DATE_MISMATCH_EXCLUDED'
}
No attendance reports found within the IST day window
📝 Processing online meeting: "test"
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_Y2FjNTM2ZDUtMTkxZi00OGY1LWE1ZDAtODRhYjQ2NjFhOTQw@thread.v2        
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19ZMkZqTlRNMlpEVXRNVGt4WmkwME9HWTFMV0UxWkRBdE9EUmhZalEyTmpGaE9UUXdAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19ZMkZqTlRNMlpEVXRNVGt4WmkwME9HWTFMV0UxWkRBdE9EUmhZalEyTmpGaE9UUXdAdGhyZWFkLnYy')/attendanceReports",
  "value": []
}
✅ AGENT FINAL FILTER: Including Team 1 (timeEntryDate: 2025-07-30)
❌ AGENT FINAL FILTER: Excluding lol (timeEntryDate: undefined, target: 2025-07-30)
❌ AGENT FINAL FILTER: Excluding test (timeEntryDate: undefined, target: 2025-07-30)

╔════════════════════════════════════════════════════════╗
║ 🏁 MEETING FETCH COMPLETED
║ 📊 Total meetings: 1 | With attendance: 1
║ 👥 Unique attendees: 0
╚════════════════════════════════════════════════════════╝
Found 1 meetings for processing

╔════════════════════════════════════════════════════════╗
║ 🔄 STARTING BATCH PROCESSING [batch_1753870531986_la5cff99i]
║ 📊 Total meetings: 1
║ 🆔 Cycle ID: cycle_1753870531986
╚════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ ▶️ Processing batch 1/1 (1 meetings) │
└─────────────────────────────────────────────────┘
📶 Rate limiter status: 48/5 tokens available
✅ Rate limiter tokens acquired
📑 Processing meeting: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]
📥 QUEUE: Added meeting "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]
📊 QUEUE STATUS: 1 item waiting
⚙️ QUEUE: Starting queue processor...

╔════════════════════════════════════════════════════════╗
║ 🔄 QUEUE PROCESSOR STARTED                             ║
║ 🆔 Cycle ID: cycle_1753870531991                   ║
║ 📊 Queue Length: 1                  ║
╚════════════════════════════════════════════════════════╝
✅ RATE LIMITER: Token acquired, processing next queue item
🔍 PROCESSING: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]
🔧 CACHE CHECK: Meeting "Team 1"
🔧 CACHE CHECK: Current reports: 2, Cached reports: 1
🔄 NEW REPORTS DETECTED: Found 2 reports vs 1 cached. Forcing reprocessing...

┌─────────────────── MEETING TIME INFO ─────────────────────┐
│ 📅 Meeting UTC: 2025-07-30T13:30:00.0000000                 │
│ 🕒 Meeting IST: 7/30/2025, 1:30:00 PM                        │
│ ⏰ Hour (IST): 13                     │
│ 🌅 Early Morning: NO        │
│ 🎯 Target Date: 2025-07-30        │
│ 📊 Validation Date: 2025-07-30T00:00:00.0000000                        │
└─────────────────────────────────────────────────────────┘
🔧 DEBUG: Starting validation of 2 reports
🔧 DEBUG: Validating report 1/2: c1ab2627-9bb0-4e61-a09f-feb1ef598a41
Report validation [IST]: Report date: 2025-07-30, Target date: 2025-07-30
🔧 DEBUG: Report c1ab2627-9bb0-4e61-a09f-feb1ef598a41 validation result: {
  isValid: true,
  reason: 'Report is valid for the specified date',
  reportDate: '2025-07-30',
  duration: 83.399
}
✅ DEBUG: Report c1ab2627-9bb0-4e61-a09f-feb1ef598a41 is VALID - added to validReports
🔧 DEBUG: Validating report 2/2: 5357853f-62a4-4b25-88e2-d015dd9df9af
Report validation [IST]: Report date: 2025-07-30, Target date: 2025-07-30
🔧 DEBUG: Report 5357853f-62a4-4b25-88e2-d015dd9df9af validation result: {
  isValid: true,
  reason: 'Report is valid for the specified date',
  reportDate: '2025-07-30',
  duration: 68.484
}
✅ DEBUG: Report 5357853f-62a4-4b25-88e2-d015dd9df9af is VALID - added to validReports
🔧 DEBUG: Validation complete. Valid reports: 2/2

┌─────────────────────── ALL VALID REPORTS ───────────────────────┐
│ 📊 Found 2 valid reports for processing              │
│ 📅 Meeting Date: 2025-07-30T00:00:00.0000000                                 │
│ 🔄 Is Recurring: false                                 │
└─────────────────────────────────────────────────────────────────┘
✅ Report c1ab2627-9bb0-4e61-a09f-feb1ef598a41: 1m 23.399s
✅ Report 5357853f-62a4-4b25-88e2-d015dd9df9af: 1m 8.483999999999995s
🔄 Found 2 valid reports for meeting (user rejoined multiple times)
Using latest report for main meeting object: c1ab2627-9bb0-4e61-a09f-feb1ef598a41
✅ COMPLETED: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=] in 4.95s

╔════════════════════════════════════════════════════════╗
║ ✅ QUEUE PROCESSOR COMPLETED                           ║
║ 🆔 Cycle ID: cycle_1753870531991                   ║
║ ⏱️ Duration: 6.21s      ║
╚════════════════════════════════════════════════════════╝
✅ Successfully processed: "Team 1" [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=]

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      │
│ ✓ Progress: 1/1 meetings (100%)    │
│ ✓ Success: 1 | Failed: 0               │
└─────────────────────────────────────────────────┘

╔════════════════════════════════════════════════════════╗
║ 🏁 BATCH PROCESSING COMPLETED [batch_1753870531986_la5cff99i]
║ 📊 Total: 1 | Success: 1 | Failed: 0
║ 📈 Success rate: 100%
╚════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════╗
║ ⏱️ CYCLE COMPLETED                                     ║
║ 🆔 Cycle ID: null                   ║
║ ⌛ Duration: 6.22s      ║
╚════════════════════════════════════════════════════════╝
Started batch processing with ID: batch_1753870531986_la5cff99i
Progress: 1/1 meetings processed
All meetings processed
Successfully processed 1 meetings
Filtering out already processed meetings and meetings the user didn't attend...

╔══════════════════════════════════════════════════════════╗
║ 🔍 MEETING FILTER STARTING                                ║
║ 📊 Input meetings: 1 | After dedup: 1                    ║
║ 🔄 Batch size: 3 | Delay: 15s                        ║
╚══════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ 📦 Processing batch 1/1 (1 meetings) ║
└─────────────────────────────────────────────────┘
🔧 DEBUG: Checking meeting "Team 1"
🔧 DEBUG: meeting.attendance exists: true
🔧 DEBUG: allValidReports length: 2
🔧 DEBUG: allValidReports: [
  {
    selectedReportId: 'c1ab2627-9bb0-4e61-a09f-feb1ef598a41',
    confidence: 1,
    reason: 'Valid report instance from 2025-07-30T10:13:44.695Z',
    metadata: {
      date: '2025-07-30T00:00:00.0000000',
      duration: 83.399,
      isRecurring: false,
      totalReports: 2
    }
  },
  {
    selectedReportId: '5357853f-62a4-4b25-88e2-d015dd9df9af',
    confidence: 1,
    reason: 'Valid report instance from 2025-07-30T08:19:15.529Z',
    metadata: {
      date: '2025-07-30T00:00:00.0000000',
      duration: 68.484,
      isRecurring: false,
      totalReports: 2
    }
  }
]
🔧 DEBUG: meeting.attendance.reportId: c1ab2627-9bb0-4e61-a09f-feb1ef598a41
🔄 ENTERING MULTIPLE REPORTS BRANCH for "Team 1"
🔍 Checking if user pradeepg@m365x92504196.onmicrosoft.com attended report c1ab2627-9bb0-4e61-a09f-feb1ef598a41
🔍 Getting duration for user pradeepg@m365x92504196.onmicrosoft.com in report c1ab2627-9bb0-4e61-a09f-feb1ef598a41
✅ Found user duration in main report: 80 seconds
✅ User pradeepg@m365x92504196.onmicrosoft.com attended report c1ab2627-9bb0-4e61-a09f-feb1ef598a41 for 80 seconds
🔍 Getting duration for user pradeepg@m365x92504196.onmicrosoft.com in report c1ab2627-9bb0-4e61-a09f-feb1ef598a41
✅ Found user duration in main report: 80 seconds
✅ Report c1ab2627-9bb0-4e61-a09f-feb1ef598a41 not posted - creating instance with duration 80s
🔧 DEBUG: Created instance with reportId = c1ab2627-9bb0-4e61-a09f-feb1ef598a41, instanceId = AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-c1ab2627
🔍 Checking if user pradeepg@m365x92504196.onmicrosoft.com attended report 5357853f-62a4-4b25-88e2-d015dd9df9af
🔍 Getting duration for user pradeepg@m365x92504196.onmicrosoft.com in report 5357853f-62a4-4b25-88e2-d015dd9df9af
🌐 Report 5357853f-62a4-4b25-88e2-d015dd9df9af is different from main report c1ab2627-9bb0-4e61-a09f-feb1ef598a41 - fetching actual attendance
📡 Fetching actual attendance for user pradeepg@m365x92504196.onmicrosoft.com in report 5357853f-62a4-4b25-88e2-d015dd9df9af
📊 Fetched 1 attendance records for report 5357853f-62a4-4b25-88e2-d015dd9df9af
✅ Found user pradeepg@m365x92504196.onmicrosoft.com in report 5357853f-62a4-4b25-88e2-d015dd9df9af with duration: 1m 4s
✅ Fetched actual user duration for report 5357853f-62a4-4b25-88e2-d015dd9df9af: 64 seconds
✅ User pradeepg@m365x92504196.onmicrosoft.com attended report 5357853f-62a4-4b25-88e2-d015dd9df9af for 64 seconds
🔍 Getting duration for user pradeepg@m365x92504196.onmicrosoft.com in report 5357853f-62a4-4b25-88e2-d015dd9df9af
🌐 Report 5357853f-62a4-4b25-88e2-d015dd9df9af is different from main report c1ab2627-9bb0-4e61-a09f-feb1ef598a41 - fetching actual attendance
📡 Fetching actual attendance for user pradeepg@m365x92504196.onmicrosoft.com in report 5357853f-62a4-4b25-88e2-d015dd9df9af
📊 Fetched 1 attendance records for report 5357853f-62a4-4b25-88e2-d015dd9df9af
✅ Found user pradeepg@m365x92504196.onmicrosoft.com in report 5357853f-62a4-4b25-88e2-d015dd9df9af with duration: 1m 4s
✅ Fetched actual user duration for report 5357853f-62a4-4b25-88e2-d015dd9df9af: 64 seconds
✅ Report 5357853f-62a4-4b25-88e2-d015dd9df9af not posted - creating instance with duration 64s
🔧 DEBUG: Created instance with reportId = 5357853f-62a4-4b25-88e2-d015dd9df9af, instanceId = AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-5357853f

╔════════════════════════════════════════════════════════╗
║ 🔄 MEETING SPLIT INTO 2 INSTANCES (MULTIPLE SESSIONS) ║
║ 📝 Meeting: "Team 1"                       ║
║ 🆔 Original ID: AAMkADZhZTY4NjljLTg2...     ║
╚════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      ║
│ 📊 Total: 1 | Unique: 2 | Duplicates: -1   ║
└─────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════╗
║ 🏁 MEETING FILTER COMPLETED                               ║
║ 📊 Processed: 1 | Duplicates: -1 | Unique: 2     ║
║ 📈 Duplication rate: -100%                                   ║
╚══════════════════════════════════════════════════════════╝
User pradeepg@m365x92504196.onmicrosoft.com attended meeting "Team 1" for 80 seconds
User pradeepg@m365x92504196.onmicrosoft.com attended meeting "Team 1" for 64 seconds
Found 2 unique meetings, 2 of which were attended by the user
Checking review queue for meetings that might now have matching tasks...
Found 1 meetings in review queue for user pradeepg@m365x92504196.onmicrosoft.com
Review queue reportIds: [5357853f-62a4-4b25-88e2-d015dd9df9af]
Excluding meeting "Team 1" (reportId: 5357853f-62a4-4b25-88e2-d015dd9df9af) from new processing - already in review queue
Filtered meetings: 2 total → 1 new (1 already in review)
Added review meeting to reprocessing: Team 1 (reportId: 5357853f-62a4-4b25-88e2-d015dd9df9af)
Total meetings to process (new: 1 + review: 1): 2
Matching tasks to all meetings (new + review queue)...
Matching tasks for meeting: Team 1
Found user's attendance record with duration: 80 seconds
Getting API key from SQLite for user: pradeepg@m365x92504196.onmicrosoft.com
Database: Looking up user by email: pradeepg@m365x92504196.onmicrosoft.com
Database: Found user pradeepg@m365x92504196.onmicrosoft.com with API key: Yes
API key found in SQLite database for user: pradeepg@m365x92504196.onmicrosoft.com
Fetching tasks from Intervals for user: pradeepg@m365x92504196.onmicrosoft.com
Fetching tasks using standard API implementation...
Current user personid: 425182
Raw tasks API response: Found 5 total tasks
Total tasks from API: 5
Task 16774501 (Daily Status Report) skipped: Task is closed
Found 4 open tasks assigned to user 425182
Standard API returned 4 tasks
Found 4 tasks in Intervals:
- WD task internal (16774641)
- testing department QA (16774644)
- migration task (16774646)
- sandisk task (16774660)
Meeting analysis for matching: {
  "subject": "Team 1",
  "startTime": "2025-07-30T13:30:00.0000000",
  "endTime": "2025-07-30T14:00:00.0000000",
  "duration": 80,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "pradeepg",
        "email": "pradeepg@m365x92504196.onmicrosoft.com",
        "duration": 80,
        "role": "Presenter",
        "attendanceIntervals": []
      }
    ],
    "summary": {
      "totalDuration": 80,
      "averageDuration": 80,
      "totalParticipants": 1
    },
    "reportId": "c1ab2627-9bb0-4e61-a09f-feb1ef598a41"
  }
}
Tasks data for matching: [
  {
    "id": "16774641",
    "title": "WD task internal",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774644",
    "title": "testing department QA",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553551",
    "module": "Quality Assurance",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774646",
    "title": "migration task",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774660",
    "title": "sandisk task",
    "projectid": "1433679",
    "project": "Sandisk Migration",
    "status": "Open",
    "priority": "3",
    "clientid": "392220",
    "client": "Sandisk",
    "moduleid": "553550",
    "module": "Development",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Sandisk Migration"
    }
  }
]
Generated prompt for OpenAI: You are an AI assistant for an IT company that matches technical meetings with appropriate development tasks. Your goal is time tracking, not perfect categorization - a reasonable guess is better than no match.

Meeting Details:
{
  "subject": "Team 1",
  "startTime": "2025-07-30T13:30:00.0000000",
  "endTime": "2025-07-30T14:00:00.0000000",
  "duration": 80,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "pradeepg",
        "email": "pradeepg@m365x92504196.onmicrosoft.com",
        "duration": 80,
        "role": "Presenter",
        "attendanceIntervals": []
      }
    ],
    "summary": {
      "totalDuration": 80,
      "averageDuration": 80,
      "totalParticipants": 1
    },
    "reportId": "c1ab2627-9bb0-4e61-a09f-feb1ef598a41"
  }
}

Available Tasks:
[
  {
    "id": "16774641",
    "title": "WD task internal",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774644",
    "title": "testing department QA",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553551",
    "module": "Quality Assurance",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774646",
    "title": "migration task",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774660",
    "title": "sandisk task",
    "projectid": "1433679",
    "project": "Sandisk Migration",
    "status": "Open",
    "priority": "3",
    "clientid": "392220",
    "client": "Sandisk",
    "moduleid": "553550",
    "module": "Development",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Sandisk Migration"
    }
  }
]

CORE PHILOSOPHY:
FIND MEANINGFUL MATCHES - The goal is accurate time tracking with reasonable confidence. When no clear connection exists, let human reviewers decide.

SMART MATCHING STRATEGY:

1. MULTI-LAYER MATCHING APPROACH
Apply these layers in order, but STOP if no reasonable connection is found:

Layer 1: EXACT/DIRECT matches (keywords, project names, client names, abbreviations)
- SD → SanDisk (check for "sandisk task" FIRST)
- WD → Western Digital
- Client names must match exactly before considering parent companies
- COMPANY PREFIX PRIORITY: When both company abbreviation AND shared keywords exist, company match wins
- Example: "SD: Separation project" → "Sandisk Tenant Separation" (SD+Separation = strong match)
- Example: "WD: Separation project" → "Sandisk Tenant Separation" (No match - WD≠SanDisk, despite shared "Separation")

Layer 2: SEMANTIC matches (related concepts, synonyms, context clues)
- Employee events → HR tasks
- Celebrations, parties, team building → HR Meetings
- Training, onboarding, reviews → HR tasks
- Benefits, policies, announcements → HR tasks

Layer 3: DEPARTMENTAL matches (meeting type suggests department)
- HR DEPARTMENT: celebrations, founder day, employee events, team building, training, reviews, benefits, policies, announcements, company events
- Development: coding, programming, APIs, features, bugs
- QA: testing, quality, bugs, defects
- DevOps: deployment, pipelines, infrastructure
- Support: tickets, incidents, troubleshooting
Layer 4: COMPANY/CLIENT matches (team calls, client meetings, but NOT parent company substitutions)
Layer 5: CONTEXTUAL matches (user's most active projects/clients)

STOP HERE: If no match found in layers 1-5, return empty array for human review

CRITICAL: Layer 1 matches take absolute priority. Company abbreviation + keyword combination beats keyword-only matches.

2. DYNAMIC ABBREVIATION & SYNONYM RECOGNITION
INTELLIGENT MATCHING RULES:
- Extract company names from meeting titles and match to task clients
- Recognize common abbreviations:
  * WD = Western Digital
  * SD = SanDisk
  * MS = Microsoft
  * AWS = Amazon Web Services
- COMPANY + KEYWORD COMBINATION MATCHING:
  * "SD: Separation project" + "Sandisk Tenant Separation" = STRONG MATCH (company + keyword)
  * "WD: Separation project" + "Sandisk Tenant Separation" = NO MATCH (wrong company, despite shared keyword)
  * Company abbreviation must align with task client for keyword matches to be valid
- ALWAYS check for EXACT client/company matches FIRST before looking for parent companies
- Match team/department calls to relevant departmental tasks
- Connect project codenames to actual project names
- Associate meeting attendees with their typical project areas
- Link recurring meeting patterns to ongoing tasks

3. CONFIDENCE SCORING FRAMEWORK
CONFIDENCE CALCULATION:
- 1.0: Exact keyword/title match
- 0.8-0.9: Strong semantic or company match
- 0.6-0.7: Good contextual or departmental match
- 0.4-0.5: Reasonable connection based on patterns
- 0.2-0.3: Weak but logical connection
- 0.0: No meaningful connection found (return empty array)

4. CONTEXT-AWARE ANALYSIS
ANALYZE THESE ELEMENTS:
- Meeting title/subject (primary indicator)
- Meeting duration (quick calls vs long planning sessions)
- Attendees (if available) and their roles
- Time of day/week patterns
- Recurring vs one-time meetings
- Client/company references in any form
- Technical keywords or jargon
- Project phases (planning, development, testing, deployment)

5. QUALITY GATE DECISION PROCESS
BEFORE RETURNING A MATCH, ASK:
1. "Is there a logical connection between this meeting and this task?"
2. "Would a reasonable person agree this meeting relates to this task?"
3. "Am I forcing a match just to avoid returning empty?"
4. "Is this meeting subject too generic or vague to confidently categorize?"

GENERIC/VAGUE MEETING FILTER:
NEVER match these types of generic subjects:
- Single words without context: "meeting", "call", "discussion", "sync"
- Random words unrelated to work: "joker", "test", "random", "hello"
- Generic numbered meetings: "meeting 1", "meeting 7", "call 2"
- Overly broad terms: "urgent meeting", "quick call", "catch up"
- Personal names only without context: "John", "Sarah", "Mike"

IF THE ANSWER TO ANY QUALITY GATE QUESTION IS "NO" → Return empty array for human review

WHEN TO RETURN EMPTY ARRAY:
- Meeting subject is generic, vague, or lacks meaningful context
- No clear semantic, company, or contextual connection exists
- Meeting subject is completely unrelated to available tasks (like "joker", "random")
- You're unsure about the connection and just guessing
- The match feels forced or artificial

WHEN TO RETURN A MATCH:
- Clear keyword, company, or semantic connection exists
- Meeting has specific, work-related context
- Meeting type logically relates to task department/function
- Reasonable person would agree there's a meaningful connection

6. PATTERN RECOGNITION
RECOGNIZE THESE PATTERNS:
- "Daily standup" → Daily Status Report tasks
- "Client call" → Tasks for that client
- "Team sync" → Internal coordination tasks
- "Planning session" → Project planning tasks
- "Review meeting" → QA or approval tasks
- "Troubleshooting" → Support or development tasks
- Person names only → Match to their typical collaboration areas

HR & EMPLOYEE EVENT PATTERNS:
- "Founder day", "Company celebration", "Team building" → HR Meetings/HR tasks
- "Employee training", "Onboarding", "Performance review" → HR tasks
- "Benefits meeting", "Policy discussion", "Company announcement" → HR tasks
- "Holiday party", "Team lunch", "Employee appreciation" → HR Meetings
- "All hands", "Town hall", "Company meeting" → HR or internal coordination tasks

AVOID GENERIC MATCHES:
- DO NOT match generic words like "meeting", "call", "sync" to HR tasks just because they contain meeting-related terms
- DO NOT match random or unrelated words like "joker", "test", "hello" to any tasks
- DO NOT match numbered generic meetings like "meeting 7", "call 2" without additional context
- REQUIRE specific, contextual keywords for HR matching (not just the word "meeting")

7. UNIVERSAL CLIENT/COMPANY MATCHING
COMPANY IDENTIFICATION:
- Extract any company names, abbreviations, or brand references
- Match meeting organizer's domain to potential clients
- Recognize common business abbreviations dynamically
- Connect subsidiary names to parent companies
- Match product names to their manufacturers

8. ADAPTIVE REASONING APPROACH
THINK LIKE A PROJECT MANAGER:
- Consider: "What would this meeting most likely be about?"
- Ask: "Which task would benefit from this meeting time?"
- Remember: "Imperfect categorization is better than no categorization"
- Default: "When in doubt, pick the most active relevant task"

IT DEPARTMENT SPECIALIZATIONS:
1. Software Development:
   - Topics: API integration, code reviews, software architecture, sprint planning, bug fixes, feature development
   - Keywords: coding, development, programming, frontend, backend, APIs, database, frameworks, libraries

2. DevOps & CI/CD:
   - Topics: pipeline automation, deployment strategies, infrastructure as code, continuous integration
   - Keywords: Jenkins, Docker, Kubernetes, GitLab CI, GitHub Actions, pipelines, automation, deployment

3. Infrastructure & Cloud:
   - Topics: server management, cloud architecture, network configuration, capacity planning
   - Keywords: AWS, Azure, GCP, servers, VMs, containers, networking, storage, load balancing

4. QA & Testing:
   - Topics: test planning, automation testing, quality assurance, regression testing, performance testing
   - Keywords: QA, testing, test cases, test automation, quality, bugs, defects, selenium, cypress

5. IT Support & Helpdesk:
   - Topics: incident management, user support, troubleshooting, ticket resolution
   - Keywords: tickets, support, helpdesk, incidents, user problems, troubleshooting, service desk

6. Security & Compliance:
   - Topics: vulnerability assessment, security audits, compliance monitoring, access management
   - Keywords: security, vulnerabilities, audits, compliance, firewall, authentication, authorization

7. Data & Analytics:
   - Topics: data modeling, analytics implementation, reporting, database management
   - Keywords: data warehouse, ETL, analytics, reporting, dashboards, BI, SQL, data modeling

8. System Administration:
   - Topics: system maintenance, updates, monitoring, user management
   - Keywords: Active Directory, user accounts, system updates, monitoring, patching, SCCM, Intune

9. Human Resources & Administration:
   - Topics: employee events, celebrations, training, reviews, benefits, policies, company meetings
   - Keywords: HR, founder day, celebration, party, team building, training, onboarding, benefits, policy, announcement, all hands, town hall, employee, company event

MATCHING RULES:
1. ONLY match with tasks that are assigned to the current user (check assigneeid field)
2. NEVER match with tasks that have a "Closed" status
3. PRIORITIZE EXACT CLIENT/COMPANY MATCHES over parent company relationships
4. COMPANY + KEYWORD VALIDATION: Both company abbreviation AND keywords must align with the same task
5. If the client is "Nathcorp", note that these are internal non-billable tasks
6. Apply multi-layer matching approach systematically - but Layer 1 (EXACT) takes absolute priority
7. Use dynamic abbreviation and synonym recognition with company validation
8. Always attempt contextual and pattern-based matching
9. Meeting duration is NOT a reliable indicator of meeting type

DISAMBIGUATION LOGIC:
- When multiple meetings share keywords but have different company prefixes
- Only match the meeting whose company abbreviation aligns with the task client
- Example: "SD: X" matches "Sandisk X task", "WD: X" does NOT match "Sandisk X task"

OUTPUT REQUIREMENTS:
RETURN A MATCH ONLY WHEN:
- There's a logical connection between meeting and task
- Confidence is at least 0.2 (weak but logical connection)
- A reasonable person would agree the match makes sense

RETURN EMPTY ARRAY WHEN:
- Meeting subject is generic, vague, or lacks meaningful context
- No meaningful connection can be established
- All potential matches feel forced or artificial
- You're just guessing without logical basis
- Meeting subject is random/unrelated (like "joker", "test", "hello")
- Generic numbered meetings without context ("meeting 7", "call 2")
- Single generic words ("meeting", "call", "sync", "discussion")
- Meeting is clearly personal/non-work related
- No tasks are assigned to the user
- All tasks are closed

HUMAN REVIEW IS VALUABLE - Don't avoid it by forcing poor matches.

EXAMPLE MATCHING LOGIC:

Meeting: "Western Digital Team Call"
Analysis:
1. Company identified: "Western Digital"
2. Check for "WD", "Western Digital", "Western", "Digital" in tasks
3. Found: "WD task internal" - strong company match
4. Confidence: 0.7 (clear company connection)
5. Match found!

Meeting: "meetings"
Analysis:
1. Keywords: "meetings" (generic singular word)
2. This is a generic term without specific context
3. Quality gate check: "Is this too generic to confidently categorize?" → Yes
4. Quality gate check: "Would a reasonable person agree 'meetings' relates to HR Meetings?" → No, too vague
5. DECISION: Return empty array - meeting subject lacks meaningful context
6. Result: No match found - needs human review

Meeting: "joker"
Analysis:
1. Keywords: "joker" (random, unrelated to work)
2. No work-related context or meaning
3. Quality gate check: "Is there logical connection to any task?" → No
4. Quality gate check: "Is this random/unrelated?" → Yes
5. DECISION: Return empty array - completely unrelated subject
6. Result: No match found - needs human review

Meeting: "urgent meeting"
Analysis:
1. Keywords: "urgent", "meeting" (generic/vague)
2. "Urgent" adds no specific context about meeting purpose
3. Quality gate check: "Is this too generic to confidently categorize?" → Yes
4. Quality gate check: "Would reasonable person agree this relates to specific task?" → No, could be anything
5. DECISION: Return empty array - lacks meaningful context
6. Result: No match found - needs human review

Meeting: "WD: Separation project 4"
Analysis:
1. Keywords: "WD", "Separation", "project"
2. "WD" = "Western Digital" (company abbreviation)
3. Check available tasks for Western Digital + Separation keywords
4. Found: "Sandisk Tenant Separation client call" - but this is SanDisk, not Western Digital
5. Company mismatch: WD (Western Digital) ≠ SanDisk
6. Quality gate check: "Would WD separation work relate to SanDisk task?" → No logical connection
7. DECISION: Return empty array - company abbreviations don't align
8. Result: No match found - needs human review

Meeting: "API Discussion"
Analysis:
1. Technical keyword: "API"
2. Look for development, integration, or technical tasks
3. Match to relevant development task
4. Confidence: 0.8 (clear technical match)
5. Match found!

Meeting: "Task Test 1"
Analysis:
1. Keywords: "Task", "Test"
2. "Test" suggests QA/Testing department
3. Look for testing, QA, or quality assurance tasks
4. Found: "testing department QA" - semantic match
5. Confidence: 0.6 (clear testing context)
6. Match found!

Analyze the meeting and tasks using the universal matching strategy, then provide your response in the following JSON format:

{
    "matchedTasks": [
        {
            "taskId": "string",
            "taskTitle": "string",
            "meetingDetails": {
                "subject": "string",
                "startTime": "string",
                "endTime": "string",
                "actualDuration": number  // Use the duration from attendance records in seconds
            },
            "confidence": number,
            "reason": "string"
        }
    ]
}

Notes:
1. Apply the multi-layer matching approach systematically
2. Use adaptive reasoning like a project manager
3. Always attempt to find at least one match for work meetings
4. Confidence should reflect the matching layer used
5. Provide clear reasoning for the match found
6. Return valid JSON that can be parsed directly
7. Include all required fields for each task
8. The actualDuration should be taken from attendance records in seconds
9. Think inclusively but don't force matches - quality over quantity
10. Remember: Human review is valuable for ambiguous cases
OpenAI response: {
    "matchedTasks": [],
    "reason": "The meeting subject 'Team 1' is too generic and lacks meaningful context. There are no specific keywords, company names, technical terms, or departmental indicators that can be logically connected to any of the available tasks. According to the matching guidelines, generic numbered meetings or vague subjects should not be matched, and this meeting requires human review."
}
Raw OpenAI response: {
    "matchedTasks": [],
    "reason": "The meeting subject 'Team 1' is too generic and lacks meaningful context. There are no specific keywords, company names, technical terms, or departmental indicators that can be logically connected to any of the available tasks. According to the matching guidelines, generic numbered meetings or vague subjects should not be matched, and this meeting requires human review."
}
Extracted JSON: {
    "matchedTasks": [],
    "reason": "The meeting subject 'Team 1' is too generic and lacks meaningful context. There are no specific keywords, company names, technical terms, or departmental indicators that can be logically connected to any of the available tasks. According to the matching guidelines, generic numbered meetings or vague subjects should not be matched, and this meeting requires human review."
}
Parsed tasks: []
Parsed matching result: {
  "meetingSubject": "Team 1",
  "matchedTasks": []
}
No matches found for meeting: Team 1, queueing for review
Found user's attendance record with duration: 80 seconds
Meeting queued for review with reportId: c1ab2627-9bb0-4e61-a09f-feb1ef598a41
Adding new meeting with ID AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-c1ab2627 for user pradeepg@m365x92504196.onmicrosoft.com to reviews
Meeting queued for review: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-c1ab2627 - Team 1
Meeting queued for review: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-c1ab2627 - Team 1
Matching tasks for meeting: Team 1
Found user's attendance record with duration: 64 seconds
Getting API key from SQLite for user: pradeepg@m365x92504196.onmicrosoft.com
Database: Looking up user by email: pradeepg@m365x92504196.onmicrosoft.com
Database: Found user pradeepg@m365x92504196.onmicrosoft.com with API key: Yes
API key found in SQLite database for user: pradeepg@m365x92504196.onmicrosoft.com
Fetching tasks from Intervals for user: pradeepg@m365x92504196.onmicrosoft.com
Fetching tasks using standard API implementation...
Current user personid: 425182
Raw tasks API response: Found 5 total tasks
Total tasks from API: 5
Task 16774501 (Daily Status Report) skipped: Task is closed
Found 4 open tasks assigned to user 425182
Standard API returned 4 tasks
Found 4 tasks in Intervals:
- WD task internal (16774641)
- testing department QA (16774644)
- migration task (16774646)
- sandisk task (16774660)
Meeting analysis for matching: {
  "subject": "Team 1",
  "startTime": "2025-07-30T13:30:00.0000000",
  "endTime": "2025-07-30T14:00:00.0000000",
  "duration": 64,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "pradeepg",
        "email": "pradeepg@m365x92504196.onmicrosoft.com",
        "duration": 64,
        "role": "Presenter",
        "attendanceIntervals": []
      }
    ],
    "summary": {
      "totalDuration": 64,
      "averageDuration": 64,
      "totalParticipants": 1
    },
    "reportId": "5357853f-62a4-4b25-88e2-d015dd9df9af"
  }
}
Tasks data for matching: [
  {
    "id": "16774641",
    "title": "WD task internal",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774644",
    "title": "testing department QA",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553551",
    "module": "Quality Assurance",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774646",
    "title": "migration task",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774660",
    "title": "sandisk task",
    "projectid": "1433679",
    "project": "Sandisk Migration",
    "status": "Open",
    "priority": "3",
    "clientid": "392220",
    "client": "Sandisk",
    "moduleid": "553550",
    "module": "Development",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Sandisk Migration"
    }
  }
]
Generated prompt for OpenAI: You are an AI assistant for an IT company that matches technical meetings with appropriate development tasks. Your goal is time tracking, not perfect categorization - a reasonable guess is better than no match.

Meeting Details:
{
  "subject": "Team 1",
  "startTime": "2025-07-30T13:30:00.0000000",
  "endTime": "2025-07-30T14:00:00.0000000",
  "duration": 64,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "pradeepg",
        "email": "pradeepg@m365x92504196.onmicrosoft.com",
        "duration": 64,
        "role": "Presenter",
        "attendanceIntervals": []
      }
    ],
    "summary": {
      "totalDuration": 64,
      "averageDuration": 64,
      "totalParticipants": 1
    },
    "reportId": "5357853f-62a4-4b25-88e2-d015dd9df9af"
  }
}

Available Tasks:
[
  {
    "id": "16774641",
    "title": "WD task internal",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774644",
    "title": "testing department QA",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553551",
    "module": "Quality Assurance",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774646",
    "title": "migration task",
    "projectid": "1433677",
    "project": "UMG Project for tickets",
    "status": "Open",
    "priority": "3",
    "clientid": "392217",
    "client": "UMG",
    "moduleid": "553546",
    "module": "Discovery",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project for tickets"
    }
  },
  {
    "id": "16774660",
    "title": "sandisk task",
    "projectid": "1433679",
    "project": "Sandisk Migration",
    "status": "Open",
    "priority": "3",
    "clientid": "392220",
    "client": "Sandisk",
    "moduleid": "553550",
    "module": "Development",
    "assigneeid": "425191,425181,425193,425192,425182,425183",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Sandisk Migration"
    }
  }
]

CORE PHILOSOPHY:
FIND MEANINGFUL MATCHES - The goal is accurate time tracking with reasonable confidence. When no clear connection exists, let human reviewers decide.

SMART MATCHING STRATEGY:

1. MULTI-LAYER MATCHING APPROACH
Apply these layers in order, but STOP if no reasonable connection is found:

Layer 1: EXACT/DIRECT matches (keywords, project names, client names, abbreviations)
- SD → SanDisk (check for "sandisk task" FIRST)
- WD → Western Digital
- Client names must match exactly before considering parent companies
- COMPANY PREFIX PRIORITY: When both company abbreviation AND shared keywords exist, company match wins
- Example: "SD: Separation project" → "Sandisk Tenant Separation" (SD+Separation = strong match)
- Example: "WD: Separation project" → "Sandisk Tenant Separation" (No match - WD≠SanDisk, despite shared "Separation")

Layer 2: SEMANTIC matches (related concepts, synonyms, context clues)
- Employee events → HR tasks
- Celebrations, parties, team building → HR Meetings
- Training, onboarding, reviews → HR tasks
- Benefits, policies, announcements → HR tasks

Layer 3: DEPARTMENTAL matches (meeting type suggests department)
- HR DEPARTMENT: celebrations, founder day, employee events, team building, training, reviews, benefits, policies, announcements, company events
- Development: coding, programming, APIs, features, bugs
- QA: testing, quality, bugs, defects
- DevOps: deployment, pipelines, infrastructure
- Support: tickets, incidents, troubleshooting
Layer 4: COMPANY/CLIENT matches (team calls, client meetings, but NOT parent company substitutions)
Layer 5: CONTEXTUAL matches (user's most active projects/clients)

STOP HERE: If no match found in layers 1-5, return empty array for human review

CRITICAL: Layer 1 matches take absolute priority. Company abbreviation + keyword combination beats keyword-only matches.

2. DYNAMIC ABBREVIATION & SYNONYM RECOGNITION
INTELLIGENT MATCHING RULES:
- Extract company names from meeting titles and match to task clients
- Recognize common abbreviations:
  * WD = Western Digital
  * SD = SanDisk
  * MS = Microsoft
  * AWS = Amazon Web Services
- COMPANY + KEYWORD COMBINATION MATCHING:
  * "SD: Separation project" + "Sandisk Tenant Separation" = STRONG MATCH (company + keyword)
  * "WD: Separation project" + "Sandisk Tenant Separation" = NO MATCH (wrong company, despite shared keyword)
  * Company abbreviation must align with task client for keyword matches to be valid
- ALWAYS check for EXACT client/company matches FIRST before looking for parent companies
- Match team/department calls to relevant departmental tasks
- Connect project codenames to actual project names
- Associate meeting attendees with their typical project areas
- Link recurring meeting patterns to ongoing tasks

3. CONFIDENCE SCORING FRAMEWORK
CONFIDENCE CALCULATION:
- 1.0: Exact keyword/title match
- 0.8-0.9: Strong semantic or company match
- 0.6-0.7: Good contextual or departmental match
- 0.4-0.5: Reasonable connection based on patterns
- 0.2-0.3: Weak but logical connection
- 0.0: No meaningful connection found (return empty array)

4. CONTEXT-AWARE ANALYSIS
ANALYZE THESE ELEMENTS:
- Meeting title/subject (primary indicator)
- Meeting duration (quick calls vs long planning sessions)
- Attendees (if available) and their roles
- Time of day/week patterns
- Recurring vs one-time meetings
- Client/company references in any form
- Technical keywords or jargon
- Project phases (planning, development, testing, deployment)

5. QUALITY GATE DECISION PROCESS
BEFORE RETURNING A MATCH, ASK:
1. "Is there a logical connection between this meeting and this task?"
2. "Would a reasonable person agree this meeting relates to this task?"
3. "Am I forcing a match just to avoid returning empty?"
4. "Is this meeting subject too generic or vague to confidently categorize?"

GENERIC/VAGUE MEETING FILTER:
NEVER match these types of generic subjects:
- Single words without context: "meeting", "call", "discussion", "sync"
- Random words unrelated to work: "joker", "test", "random", "hello"
- Generic numbered meetings: "meeting 1", "meeting 7", "call 2"
- Overly broad terms: "urgent meeting", "quick call", "catch up"
- Personal names only without context: "John", "Sarah", "Mike"

IF THE ANSWER TO ANY QUALITY GATE QUESTION IS "NO" → Return empty array for human review

WHEN TO RETURN EMPTY ARRAY:
- Meeting subject is generic, vague, or lacks meaningful context
- No clear semantic, company, or contextual connection exists
- Meeting subject is completely unrelated to available tasks (like "joker", "random")
- You're unsure about the connection and just guessing
- The match feels forced or artificial

WHEN TO RETURN A MATCH:
- Clear keyword, company, or semantic connection exists
- Meeting has specific, work-related context
- Meeting type logically relates to task department/function
- Reasonable person would agree there's a meaningful connection

6. PATTERN RECOGNITION
RECOGNIZE THESE PATTERNS:
- "Daily standup" → Daily Status Report tasks
- "Client call" → Tasks for that client
- "Team sync" → Internal coordination tasks
- "Planning session" → Project planning tasks
- "Review meeting" → QA or approval tasks
- "Troubleshooting" → Support or development tasks
- Person names only → Match to their typical collaboration areas

HR & EMPLOYEE EVENT PATTERNS:
- "Founder day", "Company celebration", "Team building" → HR Meetings/HR tasks
- "Employee training", "Onboarding", "Performance review" → HR tasks
- "Benefits meeting", "Policy discussion", "Company announcement" → HR tasks
- "Holiday party", "Team lunch", "Employee appreciation" → HR Meetings
- "All hands", "Town hall", "Company meeting" → HR or internal coordination tasks

AVOID GENERIC MATCHES:
- DO NOT match generic words like "meeting", "call", "sync" to HR tasks just because they contain meeting-related terms
- DO NOT match random or unrelated words like "joker", "test", "hello" to any tasks
- DO NOT match numbered generic meetings like "meeting 7", "call 2" without additional context
- REQUIRE specific, contextual keywords for HR matching (not just the word "meeting")

7. UNIVERSAL CLIENT/COMPANY MATCHING
COMPANY IDENTIFICATION:
- Extract any company names, abbreviations, or brand references
- Match meeting organizer's domain to potential clients
- Recognize common business abbreviations dynamically
- Connect subsidiary names to parent companies
- Match product names to their manufacturers

8. ADAPTIVE REASONING APPROACH
THINK LIKE A PROJECT MANAGER:
- Consider: "What would this meeting most likely be about?"
- Ask: "Which task would benefit from this meeting time?"
- Remember: "Imperfect categorization is better than no categorization"
- Default: "When in doubt, pick the most active relevant task"

IT DEPARTMENT SPECIALIZATIONS:
1. Software Development:
   - Topics: API integration, code reviews, software architecture, sprint planning, bug fixes, feature development
   - Keywords: coding, development, programming, frontend, backend, APIs, database, frameworks, libraries

2. DevOps & CI/CD:
   - Topics: pipeline automation, deployment strategies, infrastructure as code, continuous integration
   - Keywords: Jenkins, Docker, Kubernetes, GitLab CI, GitHub Actions, pipelines, automation, deployment

3. Infrastructure & Cloud:
   - Topics: server management, cloud architecture, network configuration, capacity planning
   - Keywords: AWS, Azure, GCP, servers, VMs, containers, networking, storage, load balancing

4. QA & Testing:
   - Topics: test planning, automation testing, quality assurance, regression testing, performance testing
   - Keywords: QA, testing, test cases, test automation, quality, bugs, defects, selenium, cypress

5. IT Support & Helpdesk:
   - Topics: incident management, user support, troubleshooting, ticket resolution
   - Keywords: tickets, support, helpdesk, incidents, user problems, troubleshooting, service desk

6. Security & Compliance:
   - Topics: vulnerability assessment, security audits, compliance monitoring, access management
   - Keywords: security, vulnerabilities, audits, compliance, firewall, authentication, authorization

7. Data & Analytics:
   - Topics: data modeling, analytics implementation, reporting, database management
   - Keywords: data warehouse, ETL, analytics, reporting, dashboards, BI, SQL, data modeling

8. System Administration:
   - Topics: system maintenance, updates, monitoring, user management
   - Keywords: Active Directory, user accounts, system updates, monitoring, patching, SCCM, Intune

9. Human Resources & Administration:
   - Topics: employee events, celebrations, training, reviews, benefits, policies, company meetings
   - Keywords: HR, founder day, celebration, party, team building, training, onboarding, benefits, policy, announcement, all hands, town hall, employee, company event

MATCHING RULES:
1. ONLY match with tasks that are assigned to the current user (check assigneeid field)
2. NEVER match with tasks that have a "Closed" status
3. PRIORITIZE EXACT CLIENT/COMPANY MATCHES over parent company relationships
4. COMPANY + KEYWORD VALIDATION: Both company abbreviation AND keywords must align with the same task
5. If the client is "Nathcorp", note that these are internal non-billable tasks
6. Apply multi-layer matching approach systematically - but Layer 1 (EXACT) takes absolute priority
7. Use dynamic abbreviation and synonym recognition with company validation
8. Always attempt contextual and pattern-based matching
9. Meeting duration is NOT a reliable indicator of meeting type

DISAMBIGUATION LOGIC:
- When multiple meetings share keywords but have different company prefixes
- Only match the meeting whose company abbreviation aligns with the task client
- Example: "SD: X" matches "Sandisk X task", "WD: X" does NOT match "Sandisk X task"

OUTPUT REQUIREMENTS:
RETURN A MATCH ONLY WHEN:
- There's a logical connection between meeting and task
- Confidence is at least 0.2 (weak but logical connection)
- A reasonable person would agree the match makes sense

RETURN EMPTY ARRAY WHEN:
- Meeting subject is generic, vague, or lacks meaningful context
- No meaningful connection can be established
- All potential matches feel forced or artificial
- You're just guessing without logical basis
- Meeting subject is random/unrelated (like "joker", "test", "hello")
- Generic numbered meetings without context ("meeting 7", "call 2")
- Single generic words ("meeting", "call", "sync", "discussion")
- Meeting is clearly personal/non-work related
- No tasks are assigned to the user
- All tasks are closed

HUMAN REVIEW IS VALUABLE - Don't avoid it by forcing poor matches.

EXAMPLE MATCHING LOGIC:

Meeting: "Western Digital Team Call"
Analysis:
1. Company identified: "Western Digital"
2. Check for "WD", "Western Digital", "Western", "Digital" in tasks
3. Found: "WD task internal" - strong company match
4. Confidence: 0.7 (clear company connection)
5. Match found!

Meeting: "meetings"
Analysis:
1. Keywords: "meetings" (generic singular word)
2. This is a generic term without specific context
3. Quality gate check: "Is this too generic to confidently categorize?" → Yes
4. Quality gate check: "Would a reasonable person agree 'meetings' relates to HR Meetings?" → No, too vague
5. DECISION: Return empty array - meeting subject lacks meaningful context
6. Result: No match found - needs human review

Meeting: "joker"
Analysis:
1. Keywords: "joker" (random, unrelated to work)
2. No work-related context or meaning
3. Quality gate check: "Is there logical connection to any task?" → No
4. Quality gate check: "Is this random/unrelated?" → Yes
5. DECISION: Return empty array - completely unrelated subject
6. Result: No match found - needs human review

Meeting: "urgent meeting"
Analysis:
1. Keywords: "urgent", "meeting" (generic/vague)
2. "Urgent" adds no specific context about meeting purpose
3. Quality gate check: "Is this too generic to confidently categorize?" → Yes
4. Quality gate check: "Would reasonable person agree this relates to specific task?" → No, could be anything
5. DECISION: Return empty array - lacks meaningful context
6. Result: No match found - needs human review

Meeting: "WD: Separation project 4"
Analysis:
1. Keywords: "WD", "Separation", "project"
2. "WD" = "Western Digital" (company abbreviation)
3. Check available tasks for Western Digital + Separation keywords
4. Found: "Sandisk Tenant Separation client call" - but this is SanDisk, not Western Digital
5. Company mismatch: WD (Western Digital) ≠ SanDisk
6. Quality gate check: "Would WD separation work relate to SanDisk task?" → No logical connection
7. DECISION: Return empty array - company abbreviations don't align
8. Result: No match found - needs human review

Meeting: "API Discussion"
Analysis:
1. Technical keyword: "API"
2. Look for development, integration, or technical tasks
3. Match to relevant development task
4. Confidence: 0.8 (clear technical match)
5. Match found!

Meeting: "Task Test 1"
Analysis:
1. Keywords: "Task", "Test"
2. "Test" suggests QA/Testing department
3. Look for testing, QA, or quality assurance tasks
4. Found: "testing department QA" - semantic match
5. Confidence: 0.6 (clear testing context)
6. Match found!

Analyze the meeting and tasks using the universal matching strategy, then provide your response in the following JSON format:

{
    "matchedTasks": [
        {
            "taskId": "string",
            "taskTitle": "string",
            "meetingDetails": {
                "subject": "string",
                "startTime": "string",
                "endTime": "string",
                "actualDuration": number  // Use the duration from attendance records in seconds
            },
            "confidence": number,
            "reason": "string"
        }
    ]
}

Notes:
1. Apply the multi-layer matching approach systematically
2. Use adaptive reasoning like a project manager
3. Always attempt to find at least one match for work meetings
4. Confidence should reflect the matching layer used
5. Provide clear reasoning for the match found
6. Return valid JSON that can be parsed directly
7. Include all required fields for each task
8. The actualDuration should be taken from attendance records in seconds
9. Think inclusively but don't force matches - quality over quantity
10. Remember: Human review is valuable for ambiguous cases
OpenAI response: {
    "matchedTasks": [],
    "reason": "The meeting subject 'Team 1' is too generic and lacks any specific context, keywords, company references, or departmental clues that would allow a logical or reasonable match to any available tasks. According to the matching strategy, generic numbered meetings or vague subjects should not be matched and should be sent for human review."
}
Raw OpenAI response: {
    "matchedTasks": [],
    "reason": "The meeting subject 'Team 1' is too generic and lacks any specific context, keywords, company references, or departmental clues that would allow a logical or reasonable match to any available tasks. According to the matching strategy, generic numbered meetings or vague subjects should not be matched and should be sent for human review."
}
Extracted JSON: {
    "matchedTasks": [],
    "reason": "The meeting subject 'Team 1' is too generic and lacks any specific context, keywords, company references, or departmental clues that would allow a logical or reasonable match to any available tasks. According to the matching strategy, generic numbered meetings or vague subjects should not be matched and should be sent for human review."
}
Parsed tasks: []
Parsed matching result: {
  "meetingSubject": "Team 1",
  "matchedTasks": []
}
No matches found for meeting: Team 1, queueing for review
Found user's attendance record with duration: 64 seconds
Meeting queued for review with reportId: 5357853f-62a4-4b25-88e2-d015dd9df9af
Adding new meeting with ID AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-5357853f for user pradeepg@m365x92504196.onmicrosoft.com to reviews
Meeting queued for review: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-5357853f - Team 1
Meeting queued for review: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-5357853f - Team 1
Creating time entries...
Skipping time entry creation for meeting: Team 1 - Needs review
Skipping time entry creation for meeting: Team 1 - Needs review
 POST /api/process-meetings?userId=pradeepg%40m365x92504196.onmicrosoft.com&source=pm2 200 in 29281ms

 dublicate entries created in review:

 📝 REVIEWS DATA:
NaN
📊 Showing latest 3 reviews:

📝 Review 1:
🆔 ID: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-5357853f
👤 User: pradeepg@m365x92504196.onmicrosoft.com
📋 Subject: Team 1
📊 Status: pending
🎯 Confidence: 0
📊 Report ID: 5357853f-62a4-4b25-88e2-d015dd9df9af
📅 Created: 2025-07-30 10:15:51
---

📝 Review 2:
🆔 ID: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=-c1ab2627
👤 User: pradeepg@m365x92504196.onmicrosoft.com
📋 Subject: Team 1
📊 Status: pending
🎯 Confidence: 0
📊 Report ID: c1ab2627-9bb0-4e61-a09f-feb1ef598a41
📅 Created: 2025-07-30 10:15:46
---

📝 Review 3:
🆔 ID: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAABHrS5YAAA=
👤 User: pradeepg@m365x92504196.onmicrosoft.com
📋 Subject: Team 1
📊 Status: pending
🎯 Confidence: 0
📊 Report ID: 5357853f-62a4-4b25-88e2-d015dd9df9af
📅 Created: 2025-07-30 10:04:23
---
