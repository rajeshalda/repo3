Processing meetings for user pradeepg@m365x92504196.onmicrosoft.com from source: pm2
Fetching meetings for user: pradeepg@m365x92504196.onmicrosoft.com

╔════════════════════════════════════════════════════════╗
║ 🚀 MEETING FETCH STARTED
║ 👤 User: pradeepg@m365x9...
╚════════════════════════════════════════════════════════╝
🔑 Getting Graph API access token...
✅ Access token acquired successfully

┌─────────────────────────────────────────────────┐
│ 📅 FETCHING MEETINGS FOR EXTENDED WINDOW         │
│ 📆 IST range: 5/11/2025, 12:00:00 AM to              │
│             5/12/2025, 11:59:59 PM              │
│ 🌐 UTC range: 2025-05-09T18:30:00.000Z to              │
│             2025-05-12T18:29:59.999Z              │
└─────────────────────────────────────────────────┘
📡 Fetching meetings from Graph API...
 POST /api/pm2/agent-status 200 in 11ms
✅ Received 2 meetings from API
🔄 Found 1 recurring meeting instances:
   1. "Internal QA Test Case Prioritization" (2025-05-11T10:00:00.0000000)

┌─────────────────────────────────────────────────┐
│ 🔍 FILTERING MEETINGS FOR EXTENDED WINDOW         │
│ 📊 Total meetings before filtering: 2            │
└─────────────────────────────────────────────────┘

[RAW MEETING 1]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAFtbAWA==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==",
  "categories": [],
  "subject": "Internal QA Test Case Prioritization",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 299 313 976 545 9\r\nPasscode: Bg9UF6JY\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAAAV6S8-AAA=",
  "type": "occurrence",
  "start": {
    "dateTime": "2025-05-11T10:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-05-11T10:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "275944787",
    "tollNumber": "+1 323-618-1840"
  }
}

[RAW MEETING 2]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAFdwNJA==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAAAV6S9FAAA=",
  "categories": [],
  "subject": "Cross-Project Dependencies Meeting",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 276 495 251 846 9\r\nPasscode: kW94pe2H\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-05-09T23:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-05-10T00:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_MjU0YjM3NTktMDA2NS00NWFiLTllMmYtYzZhYjM4NzBhMmRh%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "700555156",
    "tollNumber": "+1 323-618-1840"
  }
}

┌─────────────────────────────────────────────────┐
│ ✓ MEETINGS FILTERED                            │
│ 📊 Total meetings after filtering: 1           │
└─────────────────────────────────────────────────┘
📋 Today's meetings:
   1. "Internal QA Test Case Prioritization" (10:00 AM - 10:30 AM)

┌─────────────────────────────────────────────────┐
│ 🔍 FETCHING ATTENDANCE RECORDS                  │
└─────────────────────────────────────────────────┘
📝 Processing online meeting: "Internal QA Test Case Prioriti..."
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1@thread.v2
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19NemxtWkdWbE1HUXROamcxT0MwME5EWmpMV0ZtWTJVdE5ETXlZV1JpWm1aaU1XRTFAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19NemxtWkdWbE1HUXROamcxT0MwME5EWmpMV0ZtWTJVdE5ETXlZV1JpWm1aaU1XRTFAdGhyZWFkLnYy')/attendanceReports",
  "value": [
    {
      "id": "dca0993b-d485-46df-8543-dc82daae82c0",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-11T04:17:57.13Z",
      "meetingEndDateTime": "2025-05-11T04:30:34.706Z",
      "externalEventInformation": []
    },
    {
      "id": "6a220241-1bb3-4b20-b325-daffb8bb8e96",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-10T19:46:31.449Z",
      "meetingEndDateTime": "2025-05-10T19:48:34.366Z",
      "externalEventInformation": []
    },
    {
      "id": "9cc55257-de2a-4496-8cf2-04ca3a1cf5e2",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-10T18:14:35.11Z",
      "meetingEndDateTime": "2025-05-10T18:23:18.849Z",
      "externalEventInformation": []
    },
    {
      "id": "9a1b8f93-ba5d-47b0-8d3f-c390fa80dc6f",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-10T16:38:38.825Z",
      "meetingEndDateTime": "2025-05-10T16:44:48.767Z",
      "externalEventInformation": []
    },
    {
      "id": "908d2008-146d-49f4-80e8-6af7b6886635",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-09T08:40:19.813Z",
      "meetingEndDateTime": "2025-05-09T08:45:04.898Z",
      "externalEventInformation": []
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ 🔍 ATTENDANCE REPORT TIME WINDOW                │
│ 📅 UTC: 2025-05-10T18:30:00.000Z to       │
│     2025-05-11T18:29:59.999Z                │
│ 🕒 IST: 5/11/2025, 5:30:00 AM to │
│     5/12/2025, 5:29:59 AM    │
└─────────────────────────────────────────────────┘
Report time check: {
  reportTime: '2025-05-11T04:17:57.13Z',
  reportDateStr: '2025-05-11',
  istTargetDateStr: '2025-05-11',
  isRelevant: true
}
Report time check: {
  reportTime: '2025-05-10T19:46:31.449Z',
  reportDateStr: '2025-05-11',
  istTargetDateStr: '2025-05-11',
  isRelevant: true
}
Report time check: {
  reportTime: '2025-05-10T18:14:35.11Z',
  reportDateStr: '2025-05-10',
  istTargetDateStr: '2025-05-11',
  isRelevant: false
}
Report time check: {
  reportTime: '2025-05-10T16:38:38.825Z',
  reportDateStr: '2025-05-10',
  istTargetDateStr: '2025-05-11',
  isRelevant: false
}
Report time check: {
  reportTime: '2025-05-09T08:40:19.813Z',
  reportDateStr: '2025-05-09',
  istTargetDateStr: '2025-05-11',
  isRelevant: false
}
Found 2 relevant reports, using most recent: dca0993b-d485-46df-8543-dc82daae82c0
Records data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19NemxtWkdWbE1HUXROamcxT0MwME5EWmpMV0ZtWTJVdE5ETXlZV1JpWm1aaU1XRTFAdGhyZWFkLnYy')/attendanceReports('dca0993b-d485-46df-8543-dc82daae82c0')/attendanceRecords",
  "value": [
    {
      "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
      "emailAddress": "PradeepG@M365x92504196.OnMicrosoft.com",
      "totalAttendanceInSeconds": 753,
      "role": "Organizer",
      "registrationId": null,
      "identity": {
        "@odata.type": "#microsoft.graph.communicationsUserIdentity",
        "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
        "displayName": "Pradeep Gupta",
        "tenantId": "d6b48afb-ae93-4180-bd0f-aa47c5c5b57b"
      },
      "attendanceIntervals": [
        {
          "joinDateTime": "2025-05-11T04:18:01.5131959Z",
          "leaveDateTime": "2025-05-11T04:30:34.7065009Z",
          "durationInSeconds": 753
        }
      ],
      "externalRegistrationInformation": {
        "referrer": null,
        "registrationId": null
      }
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ ✅ ATTENDANCE RECORDS FOUND                     │
│ 📊 Total Records: 1             │
│ 🕒 Meeting Start: 2025-05-11T04:17:57.13Z │
└─────────────────────────────────────────────────┘
⚠️ Meeting already processed: "Internal QA Test Case Prioriti..."

╔════════════════════════════════════════════════════════╗
║ 🏁 MEETING FETCH COMPLETED
║ 📊 Total meetings: 1 | With attendance: 0
║ 👥 Unique attendees: 0
╚════════════════════════════════════════════════════════╝
Found 1 meetings for processing

╔════════════════════════════════════════════════════════╗
║ 🔄 STARTING BATCH PROCESSING [batch_1746945171816_239ji0k5k]
║ 📊 Total meetings: 1
║ 🆔 Cycle ID: cycle_1746945171816
╚════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ ▶️ Processing batch 1/1 (1 meetings) │
└─────────────────────────────────────────────────┘
📶 Rate limiter status: 48/5 tokens available
✅ Rate limiter tokens acquired
📑 Processing meeting: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]
📥 QUEUE: Added meeting "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]
📊 QUEUE STATUS: 1 item waiting
⚙️ QUEUE: Starting queue processor...

╔════════════════════════════════════════════════════════╗
║ 🔄 QUEUE PROCESSOR STARTED                             ║
║ 🆔 Cycle ID: cycle_1746945171819                   ║
║ 📊 Queue Length: 1                  ║
╚════════════════════════════════════════════════════════╝
✅ RATE LIMITER: Token acquired, processing next queue item
🔍 PROCESSING: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]
Selected report ID: dca0993b-d485-46df-8543-dc82daae82c0 Reason: Single valid report available
✅ COMPLETED: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==] in 4.15s

╔════════════════════════════════════════════════════════╗
║ ✅ QUEUE PROCESSOR COMPLETED                           ║
║ 🆔 Cycle ID: cycle_1746945171819                   ║
║ ⏱️ Duration: 5.40s      ║
╚════════════════════════════════════════════════════════╝
✅ Successfully processed: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      │
│ ✓ Progress: 1/1 meetings (100%)    │
│ ✓ Success: 1 | Failed: 0               │
└─────────────────────────────────────────────────┘

╔════════════════════════════════════════════════════════╗
║ 🏁 BATCH PROCESSING COMPLETED [batch_1746945171816_239ji0k5k]
║ 📊 Total: 1 | Success: 1 | Failed: 0
║ 📈 Success rate: 100%
╚════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════╗
║ ⏱️ CYCLE COMPLETED                                     ║
║ 🆔 Cycle ID: null                   ║
║ ⌛ Duration: 5.41s      ║
╚════════════════════════════════════════════════════════╝
Started batch processing with ID: batch_1746945171816_239ji0k5k
Progress: 1/1 meetings processed
All meetings processed
Successfully processed 1 meetings
Filtering out already processed meetings and meetings the user didn't attend...

╔══════════════════════════════════════════════════════════╗
║ 🔍 MEETING FILTER STARTING                                ║
║ 📊 Total meetings to check: 1                           ║
║ 🔄 Batch size: 3 | Delay: 15s                        ║
╚══════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ 📦 Processing batch 1/1 (1 meetings) ║
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│ 🔍 CHECKING IF MEETING IS POSTED                │
│ 🆔 Meeting ID: AAMkADZhZTY4Njl...           │
│ 📅 Date: 2025-05-11                         │
│ ⏱️ Duration: 12m 33s                    │
│ 📊 Report ID: dca0993b-d485-46df-8543-dc82daae82c0              │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│ ✅ DUPLICATE DETECTED BY REPORT ID               │
│ 📊 Report ID: dca0993b-d485-46df-8543-dc82daae82c0                       │
│ 👤 User ID: pradeepg@m365x92504196.onmicrosoft.com                           │
│ 📝 Matched meeting: AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==    │
└─────────────────────────────────────────────────┘
✓ MATCH FOUND (by Report ID) - Meeting already posted on 2025-05-11 with duration 0.21 hours
📋 Task: Internal QA
⏭️ Duplicate: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAggI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      ║
│ 📊 Total: 1 | Unique: 0 | Duplicates: 1   ║
└─────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════╗
║ 🏁 MEETING FILTER COMPLETED                               ║
║ 📊 Total: 1 | Duplicates: 1 | Unique: 0     ║
║ 📈 Duplication rate: 100%                                   ║
╚══════════════════════════════════════════════════════════╝
Found 0 unique meetings, 0 of which were attended by the user