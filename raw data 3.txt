Processing meetings for user pradeepg@m365x92504196.onmicrosoft.com from source: pm2
Fetching meetings for user: pradeepg@m365x92504196.onmicrosoft.com

╔════════════════════════════════════════════════════════╗
║ 🚀 MEETING FETCH STARTED
║ 👤 User: pradeepg@m365x9...
╚════════════════════════════════════════════════════════╝
🔑 Getting Graph API access token...
 POST /api/pm2/agent-status 200 in 16ms
✅ Access token acquired successfully

┌─────────────────────────────────────────────────┐
│ 📅 FETCHING MEETINGS FOR EXTENDED WINDOW         │
│ 📆 IST range: 5/11/2025, 12:00:00 AM to              │
│             5/12/2025, 11:59:59 PM              │
│ 🌐 UTC range: 2025-05-09T18:30:00.000Z to              │
│             2025-05-12T18:29:59.999Z              │
└─────────────────────────────────────────────────┘
📡 Fetching meetings from Graph API...
✅ Received 2 meetings from API
🔄 Found 1 recurring meeting instances:
   1. "Internal QA Test Case Prioritization" (2025-05-11T10:00:00.0000000)

┌─────────────────────────────────────────────────┐
│ 🔍 FILTERING MEETINGS FOR EXTENDED WINDOW         │
│ 📊 Total meetings before filtering: 2            │
└─────────────────────────────────────────────────┘

[RAW MEETING 1]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAFtbAWA==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==",
  "categories": [],
  "subject": "Internal QA Test Case Prioritization",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 299 313 976 545 9\r\nPasscode: Bg9UF6JY\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAAAV6S8-AAA=",
  "type": "occurrence",
  "start": {
    "dateTime": "2025-05-11T10:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-05-11T10:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "275944787",
    "tollNumber": "+1 323-618-1840"
  }
}

[RAW MEETING 2]
{
  "@odata.etag": "W/\"Z8Z32MWuA0S5etkqKuTXaQAAFdwNJA==\"",
  "id": "AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgBGAAAAAAC1MQUliFxnRYl_nR2JkkNnBwBnxnfYxa4DRLl62Soq5NdpAAAAAAENAABnxnfYxa4DRLl62Soq5NdpAAAV6S9FAAA=",
  "categories": [],
  "subject": "Cross-Project Dependencies Meeting",
  "bodyPreview": "________________________________________________________________________________\r\nMicrosoft Teams Need help?\r\nJoin the meeting now\r\nMeeting ID: 276 495 251 846 9\r\nPasscode: kW94pe2H\r\n________________________________\r\nDial in by phone\r\n+1 323-618-184",
  "importance": "normal",
  "isAllDay": false,
  "isCancelled": false,
  "seriesMasterId": null,
  "type": "singleInstance",
  "start": {
    "dateTime": "2025-05-09T23:30:00.0000000",
    "timeZone": "India Standard Time"
  },
  "end": {
    "dateTime": "2025-05-10T00:00:00.0000000",
    "timeZone": "India Standard Time"
  },
  "attendees": [],
  "organizer": {
    "emailAddress": {
      "name": "Pradeep Gupta",
      "address": "PradeepG@M365x92504196.OnMicrosoft.com"
    }
  },
  "onlineMeeting": {
    "joinUrl": "https://teams.microsoft.com/l/meetup-join/19%3ameeting_MjU0YjM3NTktMDA2NS00NWFiLTllMmYtYzZhYjM4NzBhMmRh%40thread.v2/0?context=%7b%22Tid%22%3a%22d6b48afb-ae93-4180-bd0f-aa47c5c5b57b%22%2c%22Oid%22%3a%2290e2f3e7-ee86-4bc6-93ff-ccf55a60c528%22%7d",
    "conferenceId": "700555156",
    "tollNumber": "+1 323-618-1840"
  }
}

┌─────────────────────────────────────────────────┐
│ ✓ MEETINGS FILTERED                            │
│ 📊 Total meetings after filtering: 1           │
└─────────────────────────────────────────────────┘
📋 Today's meetings:
   1. "Internal QA Test Case Prioritization" (10:00 AM - 10:30 AM)

┌─────────────────────────────────────────────────┐
│ 🔍 FETCHING ATTENDANCE RECORDS                  │
└─────────────────────────────────────────────────┘
📝 Processing online meeting: "Internal QA Test Case Prioriti..."
Decoded URL: https://teams.microsoft.com/l/meetup-join/19:meeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1@thread.v2/0?context={"Tid":"d6b48afb-ae93-4180-bd0f-aa47c5c5b57b","Oid":"90e2f3e7-ee86-4bc6-93ff-ccf55a60c528"}
Extracted Meeting ID: 19:meeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1@thread.v2
Extracted Organizer ID: 90e2f3e7-ee86-4bc6-93ff-ccf55a60c528
🔍 Fetching attendance for meeting ID: 19:meeti...
Formatted string: 1*90e2f3e7-ee86-4bc6-93ff-ccf55a60c528*0**19:meeting_MzlmZGVlMGQtNjg1OC00NDZjLWFmY2UtNDMyYWRiZmZiMWE1@thread.v2
Base64 Meeting ID: MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19NemxtWkdWbE1HUXROamcxT0MwME5EWmpMV0ZtWTJVdE5ETXlZV1JpWm1aaU1XRTFAdGhyZWFkLnYy
Reports data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19NemxtWkdWbE1HUXROamcxT0MwME5EWmpMV0ZtWTJVdE5ETXlZV1JpWm1aaU1XRTFAdGhyZWFkLnYy')/attendanceReports",
  "value": [
    {
      "id": "dca0993b-d485-46df-8543-dc82daae82c0",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-11T04:17:57.13Z",
      "meetingEndDateTime": "2025-05-11T04:30:34.706Z",
      "externalEventInformation": []
    },
    {
      "id": "6a220241-1bb3-4b20-b325-daffb8bb8e96",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-10T19:46:31.449Z",
      "meetingEndDateTime": "2025-05-10T19:48:34.366Z",
      "externalEventInformation": []
    },
    {
      "id": "9cc55257-de2a-4496-8cf2-04ca3a1cf5e2",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-10T18:14:35.11Z",
      "meetingEndDateTime": "2025-05-10T18:23:18.849Z",
      "externalEventInformation": []
    },
    {
      "id": "9a1b8f93-ba5d-47b0-8d3f-c390fa80dc6f",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-10T16:38:38.825Z",
      "meetingEndDateTime": "2025-05-10T16:44:48.767Z",
      "externalEventInformation": []
    },
    {
      "id": "908d2008-146d-49f4-80e8-6af7b6886635",
      "totalParticipantCount": 1,
      "meetingStartDateTime": "2025-05-09T08:40:19.813Z",
      "meetingEndDateTime": "2025-05-09T08:45:04.898Z",
      "externalEventInformation": []
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ 🔍 ATTENDANCE REPORT TIME WINDOW                │
│ 📅 UTC: 2025-05-10T18:30:00.000Z to       │
│     2025-05-11T18:29:59.999Z                │
│ 🕒 IST: 5/11/2025, 5:30:00 AM to │
│     5/12/2025, 5:29:59 AM    │
└─────────────────────────────────────────────────┘
Report time check: {
  reportTime: '2025-05-11T04:17:57.13Z',
  reportDateStr: '2025-05-11',
  istTargetDateStr: '2025-05-11',
  isRelevant: true
}
Report time check: {
  reportTime: '2025-05-10T19:46:31.449Z',
  reportDateStr: '2025-05-11',
  istTargetDateStr: '2025-05-11',
  isRelevant: true
}
Report time check: {
  reportTime: '2025-05-10T18:14:35.11Z',
  reportDateStr: '2025-05-10',
  istTargetDateStr: '2025-05-11',
  isRelevant: false
}
Report time check: {
  reportTime: '2025-05-10T16:38:38.825Z',
  reportDateStr: '2025-05-10',
  istTargetDateStr: '2025-05-11',
  isRelevant: false
}
Report time check: {
  reportTime: '2025-05-09T08:40:19.813Z',
  reportDateStr: '2025-05-09',
  istTargetDateStr: '2025-05-11',
  isRelevant: false
}
Found 2 relevant reports, using most recent: dca0993b-d485-46df-8543-dc82daae82c0
Records data: {
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('90e2f3e7-ee86-4bc6-93ff-ccf55a60c528')/onlineMeetings('MSo5MGUyZjNlNy1lZTg2LTRiYzYtOTNmZi1jY2Y1NWE2MGM1MjgqMCoqMTk6bWVldGluZ19NemxtWkdWbE1HUXROamcxT0MwME5EWmpMV0ZtWTJVdE5ETXlZV1JpWm1aaU1XRTFAdGhyZWFkLnYy')/attendanceReports('dca0993b-d485-46df-8543-dc82daae82c0')/attendanceRecords",
  "value": [
    {
      "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
      "emailAddress": "PradeepG@M365x92504196.OnMicrosoft.com",
      "totalAttendanceInSeconds": 753,
      "role": "Organizer",
      "registrationId": null,
      "identity": {
        "@odata.type": "#microsoft.graph.communicationsUserIdentity",
        "id": "90e2f3e7-ee86-4bc6-93ff-ccf55a60c528",
        "displayName": "Pradeep Gupta",
        "tenantId": "d6b48afb-ae93-4180-bd0f-aa47c5c5b57b"
      },
      "attendanceIntervals": [
        {
          "joinDateTime": "2025-05-11T04:18:01.5131959Z",
          "leaveDateTime": "2025-05-11T04:30:34.7065009Z",
          "durationInSeconds": 753
        }
      ],
      "externalRegistrationInformation": {
        "referrer": null,
        "registrationId": null
      }
    }
  ]
}

┌─────────────────────────────────────────────────┐
│ ✅ ATTENDANCE RECORDS FOUND                     │
│ 📊 Total Records: 1             │
│ 🕒 Meeting Start: 2025-05-11T04:17:57.13Z │
└─────────────────────────────────────────────────┘
⚠️ Meeting already processed: "Internal QA Test Case Prioriti..."

╔════════════════════════════════════════════════════════╗
║ 🏁 MEETING FETCH COMPLETED
║ 📊 Total meetings: 1 | With attendance: 0
║ 👥 Unique attendees: 0
╚════════════════════════════════════════════════════════╝
Found 1 meetings for processing

╔════════════════════════════════════════════════════════╗
║ 🔄 STARTING BATCH PROCESSING [batch_1746944032342_1rirc42ft]
║ 📊 Total meetings: 1
║ 🆔 Cycle ID: cycle_1746944032342
╚════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ ▶️ Processing batch 1/1 (1 meetings) │
└─────────────────────────────────────────────────┘
📶 Rate limiter status: 48/5 tokens available
✅ Rate limiter tokens acquired
📑 Processing meeting: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]
📥 QUEUE: Added meeting "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]
📊 QUEUE STATUS: 1 item waiting
⚙️ QUEUE: Starting queue processor...

╔════════════════════════════════════════════════════════╗
║ 🔄 QUEUE PROCESSOR STARTED                             ║
║ 🆔 Cycle ID: cycle_1746944032350                   ║
║ 📊 Queue Length: 1                  ║
╚════════════════════════════════════════════════════════╝
✅ RATE LIMITER: Token acquired, processing next queue item
🔍 PROCESSING: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]     
Selected report ID: dca0993b-d485-46df-8543-dc82daae82c0 Reason: Single valid report available
✅ COMPLETED: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==] in 4.17s

╔════════════════════════════════════════════════════════╗
║ ✅ QUEUE PROCESSOR COMPLETED                           ║
║ 🆔 Cycle ID: cycle_1746944032350                   ║
║ ⏱️ Duration: 5.43s      ║
╚════════════════════════════════════════════════════════╝
✅ Successfully processed: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      │
│ ✓ Progress: 1/1 meetings (100%)    │
│ ✓ Success: 1 | Failed: 0               │
└─────────────────────────────────────────────────┘

╔════════════════════════════════════════════════════════╗
║ 🏁 BATCH PROCESSING COMPLETED [batch_1746944032342_1rirc42ft]
║ 📊 Total: 1 | Success: 1 | Failed: 0
║ 📈 Success rate: 100%
╚════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════╗
║ ⏱️ CYCLE COMPLETED                                     ║
║ 🆔 Cycle ID: null                   ║
║ ⌛ Duration: 5.44s      ║
╚════════════════════════════════════════════════════════╝
Started batch processing with ID: batch_1746944032342_1rirc42ft
Progress: 1/1 meetings processed
All meetings processed
Successfully processed 1 meetings
Filtering out already processed meetings and meetings the user didn't attend...

╔══════════════════════════════════════════════════════════╗
║ 🔍 MEETING FILTER STARTING                                ║
║ 📊 Total meetings to check: 1                           ║
║ 🔄 Batch size: 3 | Delay: 15s                        ║
╚══════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────┐
│ 📦 Processing batch 1/1 (1 meetings) ║
└─────────────────────────────────────────────────┘
✅ Unique: "Internal QA Test Case Prioriti..." [AAMkADZhZTY4NjljLTg2NmMtNDZhNS1hZjk5LTUxZjMxMDQzYmY4YgFRAAgI3ZAexeTAAEYAAAAAtTEFJYhcZ0WJfp0diZJDZwcAZ8Z32MWuA0S5etkqKuTXaQAAAAABDQAAZ8Z32MWuA0S5etkqKuTXaQAAFekvPwAAEA==]

┌─────────────────────────────────────────────────┐
│ ✓ Batch 1/1 completed                      ║
│ 📊 Total: 1 | Unique: 1 | Duplicates: 0   ║
└─────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════╗
║ 🏁 MEETING FILTER COMPLETED                               ║
║ 📊 Total: 1 | Duplicates: 0 | Unique: 1     ║
║ 📈 Duplication rate: 0%                                   ║
╚══════════════════════════════════════════════════════════╝
User pradeepg@m365x92504196.onmicrosoft.com attended meeting "Internal QA Test Case Prioritization" for 753 seconds
Found 1 unique meetings, 1 of which were attended by the user
Matching tasks to attended meetings...
Matching tasks for meeting: Internal QA Test Case Prioritization
Found user's attendance record with duration: 753 seconds
Fetching tasks from Intervals for user: pradeepg@m365x92504196.onmicrosoft.com
Fetching tasks using standard API implementation...
Current user personid: 423842
Raw tasks API response: Found 12 total tasks
Total tasks from API: 12
Found 12 open tasks assigned to user 423842
Standard API returned 12 tasks
Found 12 tasks in Intervals:
- Daily Status Report (16660111)
- WD Task (16660112)
- UMG Task (16660113)
- Sandisk Task (16660114)
- Infra  Task (16660116)
- Pradeep Task (16662754)
- JCET Discussion (16663154)
- Internal QA (16663158)
- 3 AM Task Project (16663162)
- Apple ios Development (16663166)
- Balaji Mixture Closing State (16663168)
- HR Monthly Report (16663171)
Meeting analysis for matching: {
  "subject": "Internal QA Test Case Prioritization",
  "startTime": "2025-05-11T09:48:01.0000000",
  "endTime": "2025-05-11T10:00:34.0000000",
  "duration": 753,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "Pradeep Gupta",
        "email": "PradeepG@M365x92504196.OnMicrosoft.com",
        "duration": 753,
        "role": "Organizer",
        "attendanceIntervals": [
          {
            "joinDateTime": "2025-05-11T04:18:01.5131959Z",
            "leaveDateTime": "2025-05-11T04:30:34.7065009Z",
            "durationInSeconds": 753
          }
        ]
      }
    ],
    "summary": {
      "totalDuration": 753,
      "averageDuration": 753,
      "totalParticipants": 1
    },
    "reportId": "dca0993b-d485-46df-8543-dc82daae82c0"
  }
}
Tasks data for matching: [
  {
    "id": "16660111",
    "title": "Daily Status Report",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16660112",
    "title": "WD Task",
    "projectid": "1428055",
    "project": "WD Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391397",
    "client": "WD",
    "moduleid": "552132",
    "module": "Production",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "WD Project"
    }
  },
  {
    "id": "16660113",
    "title": "UMG Task",
    "projectid": "1428054",
    "project": "UMG Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391396",
    "client": "UMG",
    "moduleid": "552133",
    "module": "Development",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project"
    }
  },
  {
    "id": "16660114",
    "title": "Sandisk Task",
    "projectid": "1428053",
    "project": "SanDisk Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391395",
    "client": "SanDisk",
    "moduleid": "552132",
    "module": "Production",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "SanDisk Project"
    }
  },
  {
    "id": "16660116",
    "title": "Infra  Task",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16662754",
    "title": "Pradeep Task",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16663154",
    "title": "JCET Discussion",
    "projectid": "1428199",
    "project": "JCET Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391429",
    "client": "JCET",
    "moduleid": "552133",
    "module": "Development",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "JCET Project"
    }
  },
  {
    "id": "16663158",
    "title": "Internal QA",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552134",
    "module": "Quality Assurance",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16663162",
    "title": "3 AM Task Project",
    "projectid": "1428201",
    "project": "3 AM Blue-Print",
    "status": "Open",
    "priority": "3",
    "clientid": "391430",
    "client": "3 AM",
    "moduleid": "552130",
    "module": "Design",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "3 AM Blue-Print"
    }
  },
  {
    "id": "16663166",
    "title": "Apple ios Development",
    "projectid": "1428202",
    "project": "Apple ios Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391431",
    "client": "Apple",
    "moduleid": "552129",
    "module": "Discovery",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Apple ios Project"
    }
  },
  {
    "id": "16663168",
    "title": "Balaji Mixture Closing State",
    "projectid": "1428203",
    "project": "Balaji Mixture Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391432",
    "client": "Balaji Mixture",
    "moduleid": "552132",
    "module": "Production",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Balaji Mixture Project"
    }
  },
  {
    "id": "16663171",
    "title": "HR Monthly Report",
    "projectid": "1428206",
    "project": "HR Monthly Discussion",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "HR Monthly Discussion"
    }
  }
]
Generated prompt for OpenAI: You are an AI assistant for an IT company that matches technical meetings with appropriate development tasks. Your goal is to find the most relevant task for each meeting based on concrete evidence, not assumptions.

Meeting Details:
{
  "subject": "Internal QA Test Case Prioritization",
  "startTime": "2025-05-11T09:48:01.0000000",
  "endTime": "2025-05-11T10:00:34.0000000",
  "duration": 753,
  "analysis": {
    "keyPoints": [],
    "suggestedCategories": [],
    "confidence": 0.5,
    "context": {
      "patterns": []
    }
  },
  "attendance": {
    "records": [
      {
        "name": "Pradeep Gupta",
        "email": "PradeepG@M365x92504196.OnMicrosoft.com",
        "duration": 753,
        "role": "Organizer",
        "attendanceIntervals": [
          {
            "joinDateTime": "2025-05-11T04:18:01.5131959Z",
            "leaveDateTime": "2025-05-11T04:30:34.7065009Z",
            "durationInSeconds": 753
          }
        ]
      }
    ],
    "summary": {
      "totalDuration": 753,
      "averageDuration": 753,
      "totalParticipants": 1
    },
    "reportId": "dca0993b-d485-46df-8543-dc82daae82c0"
  }
}

Available Tasks:
[
  {
    "id": "16660111",
    "title": "Daily Status Report",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16660112",
    "title": "WD Task",
    "projectid": "1428055",
    "project": "WD Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391397",
    "client": "WD",
    "moduleid": "552132",
    "module": "Production",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "WD Project"
    }
  },
  {
    "id": "16660113",
    "title": "UMG Task",
    "projectid": "1428054",
    "project": "UMG Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391396",
    "client": "UMG",
    "moduleid": "552133",
    "module": "Development",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "UMG Project"
    }
  },
  {
    "id": "16660114",
    "title": "Sandisk Task",
    "projectid": "1428053",
    "project": "SanDisk Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391395",
    "client": "SanDisk",
    "moduleid": "552132",
    "module": "Production",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "SanDisk Project"
    }
  },
  {
    "id": "16660116",
    "title": "Infra  Task",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16662754",
    "title": "Pradeep Task",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16663154",
    "title": "JCET Discussion",
    "projectid": "1428199",
    "project": "JCET Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391429",
    "client": "JCET",
    "moduleid": "552133",
    "module": "Development",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "JCET Project"
    }
  },
  {
    "id": "16663158",
    "title": "Internal QA",
    "projectid": "1428052",
    "project": "Nathcorp",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552134",
    "module": "Quality Assurance",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Nathcorp"
    }
  },
  {
    "id": "16663162",
    "title": "3 AM Task Project",
    "projectid": "1428201",
    "project": "3 AM Blue-Print",
    "status": "Open",
    "priority": "3",
    "clientid": "391430",
    "client": "3 AM",
    "moduleid": "552130",
    "module": "Design",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "3 AM Blue-Print"
    }
  },
  {
    "id": "16663166",
    "title": "Apple ios Development",
    "projectid": "1428202",
    "project": "Apple ios Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391431",
    "client": "Apple",
    "moduleid": "552129",
    "module": "Discovery",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Apple ios Project"
    }
  },
  {
    "id": "16663168",
    "title": "Balaji Mixture Closing State",
    "projectid": "1428203",
    "project": "Balaji Mixture Project",
    "status": "Open",
    "priority": "3",
    "clientid": "391432",
    "client": "Balaji Mixture",
    "moduleid": "552132",
    "module": "Production",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "Balaji Mixture Project"
    }
  },
  {
    "id": "16663171",
    "title": "HR Monthly Report",
    "projectid": "1428206",
    "project": "HR Monthly Discussion",
    "status": "Open",
    "priority": "3",
    "clientid": "391394",
    "client": "Internal",
    "moduleid": "552131",
    "module": "Out of Scope",
    "assigneeid": "423852,423842",
    "matchingContext": {
      "isActive": false,
      "hasPriority": true,
      "hasDescription": false,
      "projectContext": "HR Monthly Discussion"
    }
  }
]

IT COMPANY CONTEXT:
- We are an IT company with specialized departments handling various technical responsibilities
- Meetings are typically focused on specific departmental tasks and projects
- Each department has its own typical projects, tools, and terminology

IT DEPARTMENT SPECIALIZATIONS:
1. Software Development:
   - Topics: API integration, code reviews, software architecture, sprint planning, bug fixes, feature development
   - Keywords: coding, development, programming, frontend, backend, APIs, database, frameworks, libraries        

2. DevOps & CI/CD:
   - Topics: pipeline automation, deployment strategies, infrastructure as code, continuous integration
   - Keywords: Jenkins, Docker, Kubernetes, GitLab CI, GitHub Actions, pipelines, automation, deployment

3. Infrastructure & Cloud:
   - Topics: server management, cloud architecture, network configuration, capacity planning
   - Keywords: AWS, Azure, GCP, servers, VMs, containers, networking, storage, load balancing

4. QA & Testing:
   - Topics: test planning, automation testing, quality assurance, regression testing, performance testing       
   - Keywords: QA, testing, test cases, test automation, quality, bugs, defects, selenium, cypress

5. IT Support & Helpdesk:
   - Topics: incident management, user support, troubleshooting, ticket resolution
   - Keywords: tickets, support, helpdesk, incidents, user problems, troubleshooting, service desk

6. Security & Compliance:
   - Topics: vulnerability assessment, security audits, compliance monitoring, access management
   - Keywords: security, vulnerabilities, audits, compliance, firewall, authentication, authorization

7. Data & Analytics:
   - Topics: data modeling, analytics implementation, reporting, database management
   - Keywords: data warehouse, ETL, analytics, reporting, dashboards, BI, SQL, data modeling

8. System Administration:
   - Topics: system maintenance, updates, monitoring, user management
   - Keywords: Active Directory, user accounts, system updates, monitoring, patching, SCCM, Intune

MATCHING RULES:
1. Prioritize tasks with direct keyword matches to the meeting subject or description
2. Match meetings to the most specific department based on technical keywords in the subject/description
3. When the meeting subject is just a person's name or vague (e.g., "call me"), look for department clues in the description
4. If still unclear, default to the department where the user has the most assigned tasks
5. Meeting duration is NOT a reliable indicator of meeting type in our technical environment
6. ONLY match with tasks that are assigned to the current user (check assigneeid field)
7. NEVER match with tasks that have a "Closed" status
8. If the client is "Nathcorp", note that these are internal non-billable tasks
9. If no assigned tasks match well, return an empty matchedTasks array
10. IMPORTANT: Always return at least one matching task if ANY relevance can be determined, regardless of confidence level

CONFIDENCE SCORE GUIDELINES:
- Low (0.1-0.3): Minimal evidence, mostly based on general IT meeting patterns
- Medium (0.4-0.6): Some concrete evidence connecting to specific technical area
- High (0.7-0.9): Strong evidence with clear technical keyword matches
- Perfect (1.0): Exact match between meeting subject and technical task
- Score of 0: Task is not assigned to the user or task is closed

EXAMPLES:
✓ GOOD: Meeting "Jenkins Pipeline Troubleshooting" matches DevOps task with confidence 0.8
✓ GOOD: Meeting "Azure VM Migration Planning" matches Infrastructure task with confidence 0.9
✓ GOOD: Meeting "API Integration Discussion" matches Development task with confidence 0.8
✓ GOOD: Meeting "John" matches the most common department task type for the user with confidence 0.3
✓ GOOD: Meeting with vague title still matches best available task with confidence 0.2
✗ BAD: Meeting "Sarah" matches QA task with confidence 0.7 (no evidence of QA activity)
✗ BAD: Any match with a task not assigned to the current user (should have confidence 0)
✗ BAD: Any match with a task that has status "Closed" (should be excluded)

Analyze the meeting and tasks, then provide your response in the following JSON format:

{
    "matchedTasks": [
        {
            "taskId": "string",
            "taskTitle": "string",
            "meetingDetails": {
                "subject": "string",
                "startTime": "string",
                "endTime": "string",
                "actualDuration": number  // Use the duration from attendance records in seconds
            },
            "confidence": number,
            "reason": "string"
        }
    ]
}

Notes:
1. Only include tasks with meaningful relevance to the meeting AND assigned to the user
2. Confidence should be a number between 0 and 1
3. Provide clear reasons for each match based on specific evidence
4. Return valid JSON that can be parsed directly
5. Include all required fields for each task
6. The actualDuration should be taken from the attendance records and is in seconds
7. Tasks with status "Closed" should NEVER be included in matchedTasks
8. IMPORTANT: Return matches for ANY confidence level above 0, no matter how low - we'd rather have a low confidence match than no match at all
OpenAI response: {
    "matchedTasks": [
        {
            "taskId": "16663158",
            "taskTitle": "Internal QA",
            "meetingDetails": {
                "subject": "Internal QA Test Case Prioritization",
                "startTime": "2025-05-11T09:48:01.0000000",
                "endTime": "2025-05-11T10:00:34.0000000",
                "actualDuration": 753
            },
            "confidence": 1.0,
            "reason": "The meeting subject contains 'QA' and 'Test Case', which are direct matches to the task title 'Internal QA' and the module 'Quality Assurance'. The task is assigned to the user and is open. This is a perfect match based on explicit QA/testing keywords."
        }
    ]
}
Raw OpenAI response: {
    "matchedTasks": [
        {
            "taskId": "16663158",
            "taskTitle": "Internal QA",
            "meetingDetails": {
                "subject": "Internal QA Test Case Prioritization",
                "startTime": "2025-05-11T09:48:01.0000000",
                "endTime": "2025-05-11T10:00:34.0000000",
                "actualDuration": 753
            },
            "confidence": 1.0,
            "reason": "The meeting subject contains 'QA' and 'Test Case', which are direct matches to the task title 'Internal QA' and the module 'Quality Assurance'. The task is assigned to the user and is open. This is a perfect match based on explicit QA/testing keywords."
        }
    ]
}
Extracted JSON: {
    "matchedTasks": [
        {
            "taskId": "16663158",
            "taskTitle": "Internal QA",
            "meetingDetails": {
                "subject": "Internal QA Test Case Prioritization",
                "startTime": "2025-05-11T09:48:01.0000000",
                "endTime": "2025-05-11T10:00:34.0000000",
                "actualDuration": 753
            },
            "confidence": 1.0,
            "reason": "The meeting subject contains 'QA' and 'Test Case', which are direct matches to the task title 'Internal QA' and the module 'Quality Assurance'. The task is assigned to the user and is open. This is a perfect match based on explicit QA/testing keywords."
        }
    ]
}
Parsed tasks: [
  {
    "taskId": "16663158",
    "taskTitle": "Internal QA",
    "meetingDetails": {
      "subject": "Internal QA Test Case Prioritization",
      "startTime": "2025-05-11T09:48:01.0000000",
      "endTime": "2025-05-11T10:00:34.0000000",
      "actualDuration": 753
    },
    "confidence": 1,
    "reason": "The meeting subject contains 'QA' and 'Test Case', which are direct matches to the task title 'Internal QA' and the module 'Quality Assurance'. The task is assigned to the user and is open. This is a perfect match based on explicit QA/testing keywords."
  }
]
Parsed matching result: {
  "meetingSubject": "Internal QA Test Case Prioritization",
  "matchedTasks": [
    {
      "taskId": "16663158",
      "taskTitle": "Internal QA",
      "meetingDetails": {
        "subject": "Internal QA Test Case Prioritization",
        "startTime": "2025-05-11T09:48:01.0000000",
        "endTime": "2025-05-11T10:00:34.0000000",
        "actualDuration": 753
      },
      "confidence": 1,
      "reason": "The meeting subject contains 'QA' and 'Test Case', which are direct matches to the task title 'Internal QA' and the module 'Quality Assurance'. The task is assigned to the user and is open. This is a perfect match based on explicit QA/testing keywords."
    }
  ]
}
Using best match for meeting "Internal QA Test Case Prioritization": Task 16663158 (Internal QA) with confidence 1
Found 1 matches for meeting: Internal QA Test Case Prioritization
Creating time entries...
Creating time entry for meeting: Internal QA Test Case Prioritization

╔════════════════════════════════════════════════════════╗
║ 🚀 TIME ENTRY CREATION STARTED
║ 📝 Meeting: Internal QA Test Case Prioriti...
║ 🔄 Task: Internal QA
╚════════════════════════════════════════════════════════╝
⏳ Fetching person & task information...
 ✓ Compiled /api/intervals-proxy in 418ms (1888 modules)
Making request to intervals API: https://api.myintervals.com/me/
Making request to intervals API: https://api.myintervals.com/task/16663158?limit=500
Intervals API response: Status 200, content-type: application/json
Response data: {"personid":423842,"status":"OK","code":200,"listcount":1,"me":[{"id":"423842","localid":"2","clientid":null,"title":"","firstname":"pradeepg","lastname":null,"primaryaccount":"f","notes":"","allprojects":"t","private":"f","tips":"f","username":"pradeepg","groupid":"4","group":"Resource","client":nu...
 POST /api/intervals-proxy 200 in 1565ms
Intervals API response: Status 200, content-type: application/json
Response data: {"personid":423842,"status":"OK","code":200,"task":{"id":"16663158","localid":"8","assignee":[{"personid":"423852","assignee":"irvins","assigneeactive":"t","personlocalid":"3"},{"personid":"423842","assignee":"pradeepg","assigneeactive":"t","personlocalid":"2"}],"assigneeid":"423852,423842","followe...
 POST /api/intervals-proxy 200 in 1639ms
Retrieved task details: {
  id: '16663158',
  title: 'Internal QA',
  status: 'Open',
  client: 'Internal',
  assigneeid: '423852,423842'
}

┌─────────────────────────────────────────────────┐
│ ✓ USER & TASK INFO RETRIEVED                    │
│ 👤 User:                          │
│ 📋 Task: #16663158 - Internal QA │
│ 🏢 Client: Internal | Project: Nathcorp │
└─────────────────────────────────────────────────┘
⏳ Fetching work types for project 1428052...
Making request to intervals API: https://api.myintervals.com/projectworktype/
Intervals API response: Status 200, content-type: application/json
Response data: {"personid":423842,"status":"OK","code":200,"listcount":110,"projectworktype":[{"id":"31439430","projectid":"1428052","worktypeid":"804776","worktype":"Admin","active":"t"},{"id":"31439441","projectid":"1428053","worktypeid":"804776","worktype":"Admin","active":"t"},{"id":"31439452","projectid":"142...
 POST /api/intervals-proxy 200 in 456ms
Found 1 work types for project 1428052: [
  {
    id: '804776',
    name: 'Admin',
    projectId: '1428052',
    workTypeId: '804776',
    projectWorkTypeId: '31439430'
  }
]
ℹ️ Using worktype ID 804786 for India-Meeting
🔍 Checking attendance records for user pradeepg@m365x92504196.onmicrosoft.com...
✅ Found user's attendance record with duration: 12m 33s
💰 Billable status: NO ✗ (Client: Internal)

┌─────────────────────────────────────────────────┐
│ 📊 TIME ENTRY DETAILS                           │
│ 📆 Date: 2025-05-11 (from UTC 2025-05-11)  │
│ ⏱️ Duration: 0.21 hours (12m 33s)  │
│ 💰 Billable: No                              │
└─────────────────────────────────────────────────┘
📡 Sending time entry request to Intervals API...
Making request to intervals API: https://api.myintervals.com/time
 GET /api/pm2/status 200 in 22ms
Intervals API response: Status 200, content-type: application/json
Response data: {"personid":423842,"status":"Created","code":201,"time":{"id":"107960235","projectid":"1428052","moduleid":"552134","taskid":"16663158","worktypeid":"804786","personid":"423842","date":"2025-05-11","datemodified":"2025-05-11 06:14:08","time":"0.21","description":"Internal QA Test Case Prioritization...
 POST /api/intervals-proxy 200 in 796ms
✅ Time entry creation successful!
📝 Time entry created with ID: 107960235
💾 Saving meeting details to storage...
Saving posted meeting with time entry...
Posted timestamp: { utc: '2025-05-11T06:14:06.458Z', ist: '2025-05-11T11:44:06.458 IST' }
[2025-05-11T06:14:06.458Z] Found report ID in meeting data: dca0993b-d485-46df-8543-dc82daae82c0

╔════════════════════════ STORAGE OPERATION ════════════════════════╗
║ 💾 STORING POSTED MEETING                                         ║
║ 👤 User: pradeepg@m365x92504196.onmicrosoft.com                                               ║
║ 🔑 Meeting ID: AAMkADZhZTY4Njl...    ║
║ ⏱️ Duration: 0.21 hours         ║
║ 🏷️ Work Type: 804786   ║
║ 📊 Report ID: dca0993b-d485-4...   ║
╚═══════════════════════════════════════════════════════════════════╝

┌─────────────────────── STORAGE DETAILS ───────────────────────┐
│ ⏱️ Duration: 756s (0.21 hours)     │
│ 📊 Attendance Report ID: dca0993b-d485-46df-8543-dc82daae82c0     │
└───────────────────────────────────────────────────────────────┘
[2025-05-11T06:14:06.468Z] Adding new meeting with report ID: dca0993b-d485-46df-8543-dc82daae82c0

┌─────────────────────── STORAGE STATUS ───────────────────────┐
│ ✅ Meeting added to storage                                  │
│ 📊 Total meetings for user: 1     │
│ 📑 Report ID saved: dca0993b-d485-46df-8543-dc82daae82c0              │
│ 💾 Storage data saved successfully                           │
└───────────────────────────────────────────────────────────────┘
Successfully saved posted meeting with time entry
✅ Meeting details saved successfully

╔════════════════════════════════════════════════════════╗
║ 🏁 TIME ENTRY CREATION COMPLETED
║ ✅ Time Entry ID: 107960235
║ ⏱️ Duration: 0.21 hours
╚════════════════════════════════════════════════════════╝
Successfully created time entry for: Internal QA Test Case Prioritization